C This code was written by the program
C <TABLO  Version 6.5   January 2016>
      use tgmnz
      use gpcm
      use gsinc1
      use gsinc3
      use gsinc4
      use gsinc5
      use gsinc5b
      use gsinc6
      use gsinc7
      use gsinc8
      use gscomp
      use TGSMVL
      use gpbas1
      use tgdebg
      use gpmain1
      use smvlst0
      use psimmod1
      use psimmod2
      USE SIMRES0
      use mslave
      use gpjobs, only: GPLaunchJob,
     *   GPIsJobDone, GetNumLogicalProc, GPSLEEP
      use gpmanref, only: manreftt
      use tbtgcom1
      use init_
      include 'tggsdec1.for'
      CHARACTER*70 PROGNV
      PARAMETER(PROGNV=
     *'<init.for 30-APR-2019 (a TABLO-generated program)>')
      INTEGER PRVERI
      PARAMETER(PRVERI=41000)
      CHARACTER (LEN=9) DATES
      PARAMETER(DATES='1987-2016')
      CHARACTER*6 PRNAME
      PARAMETER(PRNAME='TGPROG')
      INTEGER DMMTOG
C Map from coefficient names in code to names in model specification
C
C      Name in code       Name used in model specification
C      ---------------------------------------------------
C         C00001            NREG
C         C00002            NCOM
C         C00003            NIND
C         C00004            NMAR
C         C00005            V1BAS
C         C00006            V2BAS
C         C00007            V3BAS
C         C00008            V4BAS
C         C00009            V5BAS
C         C00010            V6BAS
C         C00011            V1MAR
C         C00012            V2MAR
C         C00013            V3MAR
C         C00014            V4MAR
C         C00015            V5MAR
C         C00016            V1TAX
C         C00017            V2TAX
C         C00018            V3TAX
C         C00019            V4TAX
C         C00020            V5TAX
C         C00021            V1CAP
C         C00022            V1LAB
C         C00023            V1LND
C         C00024            V1PTX
C         C00025            V1OCT
C         C00026            MAKE
C         C00027            V0TAR
C         C00028            SIGMA1LAB
C         C00029            SIGMA1PRIM
C         C00030            SIGMA1
C         C00031            SIGMA1OUT
C         C00032            SIGMA2
C         C00033            SIGMA3
C         C00034            FRISCH
C         C00035            EPS
C         C00036            EXP_ELAST
C         C00037            EXP_ELAST_NT
C         C00038            ISINDIVEXP
C         C00039            ISLOCCOM
C         C00040            R001
C         C00041            R002
C         C00042            R003
C         C00043            R004
C         C00044            R005
C         C00045            R006
C         C00046            R007
C         C00047            TINY
C         C00048            V1PUR
C         C00049            V2PUR
C         C00050            V3PUR
C         C00051            V4PUR
C         C00052            V5PUR
C         C00053            V1LAB_O
C         C00054            V1PRIM
C         C00055            V1PUR_S
C         C00056            V1MAT
C         C00057            V1CST
C         C00058            V1TOT
C         C00059            PTXRATE
C         C00060            MAKE_C
C         C00061            MAKE_I
C         C00062            V2PUR_S
C         C00063            V2TOT
C         C00064            V3PUR_S
C         C00065            V3TOT
C         C00066            S3_S
C         C00067            EPSTOT
C         C00068            MARSALES
C         C00069            SALE
C         C00070            V0IMP
C         C00071            SALES
C         C00072            DOMSALES
C         C00073            V1TAX_CSI
C         C00074            V2TAX_CSI
C         C00075            V3TAX_CS
C         C00076            V4TAX_C
C         C00077            V5TAX_CS
C         C00078            V0TAR_C
C         C00079            V1CAP_I
C         C00080            V1LAB_IO
C         C00081            V1LND_I
C         C00082            V1PTX_I
C         C00083            V1OCT_I
C         C00084            V1PRIM_I
C         C00085            V0GDPINC
C         C00086            V0TAX_CSI
C         C00087            V0CIF
C         C00088            V0CIF_C
C         C00089            V0IMP_C
C         C00090            V2TOT_I
C         C00091            V4TOT
C         C00092            V5TOT
C         C00093            V6TOT
C         C00094            V0GNE
C         C00095            V0GDPEXP
C         C00096            DIFFIND
C         C00097            DIFFCOM
C         C00098            EXPGDP
C         C00099            INCGDP
C         C00100            TAX
C         C00101            COSTMAT
C         C00102            SALEMAT2
C         C00103            IMPSHR
C         C00104            SUPPLYELAST
C         C00105            FACTOR
C         C00106            V1PUR_SI
C         C00107            V2PUR_SI
C         C00108            V5PUR_S
C         C00109            V6BAS_S
C         C00110            TARFRATE
C         C00111            REGV1LAB_O
C         C00112            REGV1LAB_IO
C         C00113            REGINCSHR
C         C00114            TOTSUPREG
C         C00115            TOTDEMREG
C         C00116            DEMRATIO
C         C00117            REGV1PRIM
C         C00118            R00PRIM
C         C00119            REGV1PRIM_I
C         C00120            TOTIMPREG
C         C00121            TOTIMP
C         C00122            REGIMPSHR
C         C00123            IMPTOT
C         C00124            MSHR
C         C00125            DEFREGSHR
C         C00126            TEMTOT
C         C00127            DISTANCE
C         C00128            DISTFAC
C         C00129            MARWGT
C         C00130            LOCMAR
C         C00131            RPOP
C         C00132            SIGMADOMDOM
C         C00133            SIGMAMAR
C         C00134            XX
C         C00135            MAPREG
C         C00136            MPC
C         C00137            MAPCOM
C         C00138            MPI
C         C00139            MAPIND
C
C Declarations of all coefficients
C      REAL C00001(1),C00002(1),C00003(1),C00004(1),C00005(0,2,0)
C      REAL C00006(0,2,0),C00007(0,2),C00008(0),C00009(0,2),C00010(0,2)
C      REAL C00011(0,2,0,0),C00012(0,2,0,0),C00013(0,2,0),C00014(0,0)
C      REAL C00015(0,2,0),C00016(0,2,0),C00017(0,2,0),C00018(0,2)
C      REAL C00019(0),C00020(0,2),C00021(0),C00022(0,0),C00023(0)
C      REAL C00024(0),C00025(0),C00026(0,0),C00027(0),C00028(0)
C      REAL C00029(0),C00030(0),C00031(0),C00032(0),C00033(0),C00034(1)
C      REAL C00035(0),C00036(0),C00037(1),C00038(0),C00039(0)
C      REAL C00040(0,0),C00041(0,0),C00042(0,0),C00043(0,0),C00044(0,0)
C      REAL C00045(0,0),C00046(0,0),C00047(1),C00048(0,2,0)
C      REAL C00049(0,2,0),C00050(0,2),C00051(0),C00052(0,2),C00053(0)
C      REAL C00054(0),C00055(0,0),C00056(0),C00057(0),C00058(0)
C      REAL C00059(0),C00060(0),C00061(0),C00062(0,0),C00063(0)
C      REAL C00064(0),C00065(1),C00066(0),C00067(1),C00068(0)
C      REAL C00069(0,2,7),C00070(0),C00071(0),C00072(0),C00073(1)
C      REAL C00074(1),C00075(1),C00076(1),C00077(1),C00078(1),C00079(1)
C      REAL C00080(1),C00081(1),C00082(1),C00083(1),C00084(1),C00085(1)
C      REAL C00086(1),C00087(0),C00088(1),C00089(1),C00090(1),C00091(1)
C      REAL C00092(1),C00093(1),C00094(1),C00095(1),C00096(0),C00097(0)
C      REAL C00098(6),C00099(4),C00100(8),C00101(0,9),C00102(0,3,2,6)
C      REAL C00103(0),C00104(0),C00105(0,3),C00106(0),C00107(0)
C      REAL C00108(0),C00109(0),C00110(0),C00111(0,0),C00112(0)
C      REAL C00113(0),C00114(0,0),C00115(0,0),C00116(0,0),C00117(0,0)
C      REAL C00118(0,0),C00119(0),C00120(0,0),C00121(0),C00122(0)
C      REAL C00123(1),C00124(0,0),C00125(0),C00126(1),C00127(0,0)
C      REAL C00128(0,2),C00129(0,0),C00130(0),C00131(0),C00132(0)
C      REAL C00133(0),C00134(0)
C      INTEGER C00135(0)
C      REAL C00136(0)
C      INTEGER C00137(0)
C      REAL C00138(0)
C      INTEGER C00139(0)
C Finish of declarations of all coefficients
C Map from index names in code to names in model specification
C
C      Name in code       Name used in model specification
C      ---------------------------------------------------
C         I00001            r
C         I00002            c
C         I00003            i
C         I00004            m
C         I00005            s
C         I00006            o
C         I00007            n
C         I00008            d
C         I00012            f
C         I00013            sa
C         I00014            u
      istgprog=.TRUE.
      isgemsim=.NOT.istgprog
      dmmtog=0
      mxgsrs=0
      mxgsis=0
      mxgslg=0
      mxgsop=0
      mxgsin=0
      mxgsrc=0
      mxgsic=0
      AXSFIL='init'
      AXTFIL=AXSFIL
      include 'tggscod1.for'
      IF(DEBG(26).EQ.0) THEN
       CALL TGCAXD('tg',DATEXS,DATEXT,AXTUN,
     *   'at 14:56:10 on 30-APR-2019              ',ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      include 'tggscod2.for'
      include 'tggscod3.for'
      include 'tggscod4.for'
      CALL M00001(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00002(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00003(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00004(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00005(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00006(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00007(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00008(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL M00009(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(EXSUSE) THEN
        CALL GPREW(EXSUN,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
1000  CONTINUE
      include 'tgdeac3t.for'
      CALL M00010(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      include 'tggscod6.for'
3000  CONTINUE
 3160 CONTINUE
 3380 CONTINUE
 8260 CONTINUE
      GOTO 5900
5850  CONTINUE
      include 'tggspre1.for'
      include 'tggsei0.for'
8300  continue
7006  CONTINUE
8100  CONTINUE
      include 'tggsend2.for'
9000  CONTINUE
      include 'tggsend3.for'
      END
      SUBROUTINE S00001(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00001,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      INTEGER IS1,IS2
      LOGICAL ECHO1
      REAL C00001(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "NREG"'
      CurrentAction2=
     *  'at line 37 in the TAB file'
      CurrentIGNO=24
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "NREG"',
     *  'at line 37 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IS1=0
      DO 1 I00001=1,SSZ(1)  ! SUM(r,REG
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS1=IS1+IS2
      ELSE
        IS1=GPINTOP('+',IS1,IS2)
      END IF
    1 CONTINUE  ! END SUM(r,REG
      C00001(1)=IS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "NREG"',
     *  'at line 37 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00001')
      RETURN
      END
      SUBROUTINE S00002(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00002,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      INTEGER IS1,IS2
      LOGICAL ECHO1
      REAL C00002(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "NCOM"'
      CurrentAction2=
     *  'at line 39 in the TAB file'
      CurrentIGNO=26
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "NCOM"',
     *  'at line 39 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IS1=0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS1=IS1+IS2
      ELSE
        IS1=GPINTOP('+',IS1,IS2)
      END IF
    1 CONTINUE  ! END SUM(c,COM
      C00002(1)=IS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "NCOM"',
     *  'at line 39 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00002')
      RETURN
      END
      SUBROUTINE S00003(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00003,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      INTEGER IS1,IS2
      LOGICAL ECHO1
      REAL C00003(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "NIND"'
      CurrentAction2=
     *  'at line 41 in the TAB file'
      CurrentIGNO=28
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "NIND"',
     *  'at line 41 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IS1=0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS1=IS1+IS2
      ELSE
        IS1=GPINTOP('+',IS1,IS2)
      END IF
    1 CONTINUE  ! END SUM(i,IND
      C00003(1)=IS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "NIND"',
     *  'at line 41 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00003')
      RETURN
      END
      SUBROUTINE S00004(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00004,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      INTEGER IS1,IS2
      LOGICAL ECHO1
      REAL C00004(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "NMAR"'
      CurrentAction2=
     *  'at line 43 in the TAB file'
      CurrentIGNO=30
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "NMAR"',
     *  'at line 43 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IS1=0
      DO 1 I00004=1,SSZ(3)  ! SUM(m,MAR
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS1=IS1+IS2
      ELSE
        IS1=GPINTOP('+',IS1,IS2)
      END IF
    1 CONTINUE  ! END SUM(m,MAR
      C00004(1)=IS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "NMAR"',
     *  'at line 43 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00004')
      RETURN
      END
      SUBROUTINE M00001(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,1,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,2,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,3,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,4,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,34,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,37,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,47,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,65,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,67,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,73,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,74,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,75,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,76,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,77,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,78,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,79,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,80,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,81,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,82,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,83,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,84,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,85,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,86,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,88,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,89,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,90,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,91,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,92,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,93,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,94,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,95,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,123,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,126,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,112,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,113,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,119,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,122,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,125,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,127,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,131,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,135,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,8,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,19,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,27,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,30,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,32,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,33,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,35,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,36,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,38,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,39,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,42,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,43,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,44,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,45,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,51,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,61,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,64,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,66,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,68,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,70,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,71,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,72,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,87,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,97,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,103,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,106,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,107,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,108,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,109,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,110,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,114,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,115,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,116,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,120,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,121,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,132,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,134,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,136,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,137,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,14,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,129,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,130,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,133,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,21,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,23,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,24,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,25,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,26,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,28,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,29,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,31,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,40,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,41,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,46,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,53,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,54,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,55,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,56,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,57,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,58,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,59,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,60,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,62,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,63,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,96,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,104,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,111,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,117,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,118,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,138,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,139,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,22,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,5,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,6,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,7,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,9,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,10,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,11,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,12,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,13,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,15,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,16,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,17,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,18,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,20,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,48,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,49,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,50,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,52,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,128,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,124,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=1
       SSNO=1
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,1,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=7
       SSNO=2
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,2,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=3
       SSNO=3
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,3,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=8
       SSNO=4
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,4,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGTRHD('tg',AXSUN,DOWR,DOUD,FSTPAS,ECHO1,
     *  RDUN,WRUN,LFNORD,LFNOWR,LFFOWR,
     *  MMNFL,NUMFL,AFN,AFS,FLLNAM,FLFM,FLTYP,FLUDST,FLNTRU,
     *  RDFSNO,WRFSNO,MMNRD,NUMRD,RDHD,RDFLN,
     *  MMNWR,NUMWR,WRHD,WRFLN,
     *  MMNTR,NUMTR,TRHD,TRFLN1,TRFLN2,
     *  TRIfHeaderExists,
     *  MMNST,NUMST,STELHD,STELFN,
     *  MMNSS,NUMSS,SSENHD,SSENFN,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGTRHD('tg',AXSUN,DOWR,DOUD,FSTPAS,ECHO1,
     *  RDUN,WRUN,LFNORD,LFNOWR,LFFOWR,
     *  MMNFL,NUMFL,AFN,AFS,FLLNAM,FLFM,FLTYP,FLUDST,FLNTRU,
     *  RDFSNO,WRFSNO,MMNRD,NUMRD,RDHD,RDFLN,
     *  MMNWR,NUMWR,WRHD,WRFLN,
     *  MMNTR,NUMTR,TRHD,TRFLN1,TRFLN2,
     *  TRIfHeaderExists,
     *  MMNST,NUMST,STELHD,STELFN,
     *  MMNSS,NUMSS,SSENHD,SSENFN,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGTRHD('tg',AXSUN,DOWR,DOUD,FSTPAS,ECHO1,
     *  RDUN,WRUN,LFNORD,LFNOWR,LFFOWR,
     *  MMNFL,NUMFL,AFN,AFS,FLLNAM,FLFM,FLTYP,FLUDST,FLNTRU,
     *  RDFSNO,WRFSNO,MMNRD,NUMRD,RDHD,RDFLN,
     *  MMNWR,NUMWR,WRHD,WRFLN,
     *  MMNTR,NUMTR,TRHD,TRFLN1,TRFLN2,
     *  TRIfHeaderExists,
     *  MMNST,NUMST,STELHD,STELFN,
     *  MMNSS,NUMSS,SSENHD,SSENFN,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGTRHD('tg',AXSUN,DOWR,DOUD,FSTPAS,ECHO1,
     *  RDUN,WRUN,LFNORD,LFNOWR,LFFOWR,
     *  MMNFL,NUMFL,AFN,AFS,FLLNAM,FLFM,FLTYP,FLUDST,FLNTRU,
     *  RDFSNO,WRFSNO,MMNRD,NUMRD,RDHD,RDFLN,
     *  MMNWR,NUMWR,WRHD,WRFLN,
     *  MMNTR,NUMTR,TRHD,TRFLN1,TRFLN2,
     *  TRIfHeaderExists,
     *  MMNST,NUMST,STELHD,STELFN,
     *  MMNSS,NUMSS,SSENHD,SSENFN,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGTRHD('tg',AXSUN,DOWR,DOUD,FSTPAS,ECHO1,
     *  RDUN,WRUN,LFNORD,LFNOWR,LFFOWR,
     *  MMNFL,NUMFL,AFN,AFS,FLLNAM,FLFM,FLTYP,FLUDST,FLNTRU,
     *  RDFSNO,WRFSNO,MMNRD,NUMRD,RDHD,RDFLN,
     *  MMNWR,NUMWR,WRHD,WRFLN,
     *  MMNTR,NUMTR,TRHD,TRFLN1,TRFLN2,
     *  TRIfHeaderExists,
     *  MMNST,NUMST,STELHD,STELFN,
     *  MMNSS,NUMSS,SSENHD,SSENFN,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(24).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'NREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(24).NE.'n') then
      CALL S00001(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(24),
     *  C00001,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(26).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'NCOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(26).NE.'n') then
      CALL S00002(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(26),
     *  C00002,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(28).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'NIND',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(28).NE.'n') then
      CALL S00003(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(28),
     *  C00003,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(30).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'NMAR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(30).NE.'n') then
      CALL S00004(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(30),
     *  C00004,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('M00001')
      RETURN
      END
      SUBROUTINE S00005(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1BAS >=0"'
      CurrentAction2=
     *  'at line 137 in the TAB file'
      CurrentIGNO=115
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1BAS >=0"',
     *  'at line 137 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00005(I00002,I00005,I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,3,
     *'V1BAS >=0',
     *    I00002,I00005,I00003,0,0,0,0,
     *    2,6,4,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1BAS >=0"',
     *  'at line 137 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1BAS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00005')
      RETURN
15500 CALL PERETM('S00005',ERRMES)
      RETURN
      END
      SUBROUTINE S00006(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00006,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V2BAS >=0"'
      CurrentAction2=
     *  'at line 139 in the TAB file'
      CurrentIGNO=116
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V2BAS >=0"',
     *  'at line 139 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00006(I00002,I00005,I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,3,
     *'V2BAS >=0',
     *    I00002,I00005,I00003,0,0,0,0,
     *    2,6,4,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V2BAS >=0"',
     *  'at line 139 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V2BAS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00006')
      RETURN
15500 CALL PERETM('S00006',ERRMES)
      RETURN
      END
      SUBROUTINE S00007(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00007,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00007(SSZ(2),SSZ(6))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V3BAS >=0"'
      CurrentAction2=
     *  'at line 140 in the TAB file'
      CurrentIGNO=117
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V3BAS >=0"',
     *  'at line 140 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00007(I00002,I00005).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'V3BAS >=0',
     *    I00002,I00005,0,0,0,0,0,
     *    2,6,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V3BAS >=0"',
     *  'at line 140 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V3BAS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00007')
      RETURN
15500 CALL PERETM('S00007',ERRMES)
      RETURN
      END
      SUBROUTINE S00008(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00008,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00008(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V4BAS >=0"'
      CurrentAction2=
     *  'at line 141 in the TAB file'
      CurrentIGNO=118
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V4BAS >=0"',
     *  'at line 141 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00008(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'V4BAS >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V4BAS >=0"',
     *  'at line 141 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V4BAS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00008')
      RETURN
15500 CALL PERETM('S00008',ERRMES)
      RETURN
      END
      SUBROUTINE S00009(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00009,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00009(SSZ(2),SSZ(6))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V5BAS >=0"'
      CurrentAction2=
     *  'at line 142 in the TAB file'
      CurrentIGNO=119
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V5BAS >=0"',
     *  'at line 142 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00009(I00002,I00005).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'V5BAS >=0',
     *    I00002,I00005,0,0,0,0,0,
     *    2,6,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V5BAS >=0"',
     *  'at line 142 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V5BAS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00009')
      RETURN
15500 CALL PERETM('S00009',ERRMES)
      RETURN
      END
      SUBROUTINE S00010(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00011,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1MAR >=0"'
      CurrentAction2=
     *  'at line 143 in the TAB file'
      CurrentIGNO=120
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1MAR >=0"',
     *  'at line 143 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 4 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00011(I00002,I00005,I00003,I00004).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,4,
     *'V1MAR >=0',
     *    I00002,I00005,I00003,I00004,0,0,0,
     *    2,6,4,3,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
    4 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1MAR >=0"',
     *  'at line 143 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1MAR >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00010')
      RETURN
15500 CALL PERETM('S00010',ERRMES)
      RETURN
      END
      SUBROUTINE S00011(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00012,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00012(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V2MAR >=0"'
      CurrentAction2=
     *  'at line 144 in the TAB file'
      CurrentIGNO=121
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V2MAR >=0"',
     *  'at line 144 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 4 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00012(I00002,I00005,I00003,I00004).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,4,
     *'V2MAR >=0',
     *    I00002,I00005,I00003,I00004,0,0,0,
     *    2,6,4,3,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
    4 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V2MAR >=0"',
     *  'at line 144 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V2MAR >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00011')
      RETURN
15500 CALL PERETM('S00011',ERRMES)
      RETURN
      END
      SUBROUTINE S00012(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00013,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00013(SSZ(2),SSZ(6),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V3MAR >=0"'
      CurrentAction2=
     *  'at line 145 in the TAB file'
      CurrentIGNO=122
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V3MAR >=0"',
     *  'at line 145 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 3 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00013(I00002,I00005,I00004).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,3,
     *'V3MAR >=0',
     *    I00002,I00005,I00004,0,0,0,0,
     *    2,6,3,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V3MAR >=0"',
     *  'at line 145 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V3MAR >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00012')
      RETURN
15500 CALL PERETM('S00012',ERRMES)
      RETURN
      END
      SUBROUTINE S00013(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00014,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00014(SSZ(2),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V4MAR >=0"'
      CurrentAction2=
     *  'at line 146 in the TAB file'
      CurrentIGNO=123
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V4MAR >=0"',
     *  'at line 146 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00014(I00002,I00004).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'V4MAR >=0',
     *    I00002,I00004,0,0,0,0,0,
     *    2,3,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V4MAR >=0"',
     *  'at line 146 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V4MAR >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00013')
      RETURN
15500 CALL PERETM('S00013',ERRMES)
      RETURN
      END
      SUBROUTINE S00014(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00015,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00015(SSZ(2),SSZ(6),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V5MAR >=0"'
      CurrentAction2=
     *  'at line 147 in the TAB file'
      CurrentIGNO=124
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V5MAR >=0"',
     *  'at line 147 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 3 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00015(I00002,I00005,I00004).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,3,
     *'V5MAR >=0',
     *    I00002,I00005,I00004,0,0,0,0,
     *    2,6,3,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V5MAR >=0"',
     *  'at line 147 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V5MAR >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00014')
      RETURN
15500 CALL PERETM('S00014',ERRMES)
      RETURN
      END
      SUBROUTINE S00015(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1CAP >=0"'
      CurrentAction2=
     *  'at line 148 in the TAB file'
      CurrentIGNO=125
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1CAP >=0"',
     *  'at line 148 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00021(I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'V1CAP >=0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1CAP >=0"',
     *  'at line 148 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1CAP >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00015')
      RETURN
15500 CALL PERETM('S00015',ERRMES)
      RETURN
      END
      SUBROUTINE S00016(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00022,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER I00006
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00022(SSZ(4),SSZ(5))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1LAB >=0"'
      CurrentAction2=
     *  'at line 149 in the TAB file'
      CurrentIGNO=126
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1LAB >=0"',
     *  'at line 149 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00006=1,SSZ(5)  ! (all,o,OCC)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00022(I00003,I00006).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'V1LAB >=0',
     *    I00003,I00006,0,0,0,0,0,
     *    4,5,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,o,OCC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1LAB >=0"',
     *  'at line 149 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1LAB >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00016')
      RETURN
15500 CALL PERETM('S00016',ERRMES)
      RETURN
      END
      SUBROUTINE S00017(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00023,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00023(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1LND >=0"'
      CurrentAction2=
     *  'at line 150 in the TAB file'
      CurrentIGNO=127
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1LND >=0"',
     *  'at line 150 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00023(I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'V1LND >=0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1LND >=0"',
     *  'at line 150 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1LND >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00017')
      RETURN
15500 CALL PERETM('S00017',ERRMES)
      RETURN
      END
      SUBROUTINE S00018(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "MAKE >=0"'
      CurrentAction2=
     *  'at line 151 in the TAB file'
      CurrentIGNO=128
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "MAKE >=0"',
     *  'at line 151 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00026(I00002,I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'MAKE >=0',
     *    I00002,I00003,0,0,0,0,0,
     *    2,4,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "MAKE >=0"',
     *  'at line 151 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'MAKE >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00018')
      RETURN
15500 CALL PERETM('S00018',ERRMES)
      RETURN
      END
      SUBROUTINE S00019(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00028,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00028(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA1LAB >=0"'
      CurrentAction2=
     *  'at line 152 in the TAB file'
      CurrentIGNO=129
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA1LAB >=0"',
     *  'at line 152 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00028(I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA1LAB >=0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA1LAB >=0"',
     *  'at line 152 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA1LAB >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00019')
      RETURN
15500 CALL PERETM('S00019',ERRMES)
      RETURN
      END
      SUBROUTINE S00020(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00029,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00029(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA1PRIM >=0"'
      CurrentAction2=
     *  'at line 153 in the TAB file'
      CurrentIGNO=130
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA1PRIM >=0"',
     *  'at line 153 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00029(I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA1PRIM >=0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA1PRIM >=0"',
     *  'at line 153 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA1PRIM >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00020')
      RETURN
15500 CALL PERETM('S00020',ERRMES)
      RETURN
      END
      SUBROUTINE S00021(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00030,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00030(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA1 >=0"'
      CurrentAction2=
     *  'at line 154 in the TAB file'
      CurrentIGNO=131
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA1 >=0"',
     *  'at line 154 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00030(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA1 >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA1 >=0"',
     *  'at line 154 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA1 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00021')
      RETURN
15500 CALL PERETM('S00021',ERRMES)
      RETURN
      END
      SUBROUTINE S00022(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00031,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00031(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA1OUT >=0"'
      CurrentAction2=
     *  'at line 155 in the TAB file'
      CurrentIGNO=132
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA1OUT >=0"',
     *  'at line 155 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00031(I00003).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA1OUT >=0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA1OUT >=0"',
     *  'at line 155 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA1OUT >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00022')
      RETURN
15500 CALL PERETM('S00022',ERRMES)
      RETURN
      END
      SUBROUTINE S00023(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00032,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00032(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA2 >=0"'
      CurrentAction2=
     *  'at line 156 in the TAB file'
      CurrentIGNO=133
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA2 >=0"',
     *  'at line 156 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00032(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA2 >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA2 >=0"',
     *  'at line 156 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA2 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00023')
      RETURN
15500 CALL PERETM('S00023',ERRMES)
      RETURN
      END
      SUBROUTINE S00024(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00033,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00033(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SIGMA3 >=0"'
      CurrentAction2=
     *  'at line 157 in the TAB file'
      CurrentIGNO=134
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SIGMA3 >=0"',
     *  'at line 157 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00033(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SIGMA3 >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SIGMA3 >=0"',
     *  'at line 157 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SIGMA3 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00024')
      RETURN
15500 CALL PERETM('S00024',ERRMES)
      RETURN
      END
      SUBROUTINE S00025(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00035,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00035(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "EPS >=0"'
      CurrentAction2=
     *  'at line 158 in the TAB file'
      CurrentIGNO=135
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "EPS >=0"',
     *  'at line 158 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00035(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'EPS >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "EPS >=0"',
     *  'at line 158 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'EPS >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00025')
      RETURN
15500 CALL PERETM('S00025',ERRMES)
      RETURN
      END
      SUBROUTINE S00026(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00038,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00038(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "IsIndivExp >=0"'
      CurrentAction2=
     *  'at line 159 in the TAB file'
      CurrentIGNO=136
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "IsIndivExp >=0"',
     *  'at line 159 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00038(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'IsIndivExp >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "IsIndivExp >=0"',
     *  'at line 159 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'IsIndivExp >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00026')
      RETURN
15500 CALL PERETM('S00026',ERRMES)
      RETURN
      END
      SUBROUTINE S00027(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00039,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00039(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "IsLocCom >=0"'
      CurrentAction2=
     *  'at line 160 in the TAB file'
      CurrentIGNO=137
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "IsLocCom >=0"',
     *  'at line 160 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00039(I00002).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'IsLocCom >=0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "IsLocCom >=0"',
     *  'at line 160 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'IsLocCom >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00027')
      RETURN
15500 CALL PERETM('S00027',ERRMES)
      RETURN
      END
      SUBROUTINE S00028(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00040,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00040(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R001 >=0"'
      CurrentAction2=
     *  'at line 161 in the TAB file'
      CurrentIGNO=138
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R001 >=0"',
     *  'at line 161 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00040(I00003,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R001 >=0',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R001 >=0"',
     *  'at line 161 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R001 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00028')
      RETURN
15500 CALL PERETM('S00028',ERRMES)
      RETURN
      END
      SUBROUTINE S00029(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00041,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00041(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R002 >=0"'
      CurrentAction2=
     *  'at line 162 in the TAB file'
      CurrentIGNO=139
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R002 >=0"',
     *  'at line 162 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00041(I00003,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R002 >=0',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R002 >=0"',
     *  'at line 162 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R002 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00029')
      RETURN
15500 CALL PERETM('S00029',ERRMES)
      RETURN
      END
      SUBROUTINE S00030(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00042,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00042(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R003 >=0"'
      CurrentAction2=
     *  'at line 163 in the TAB file'
      CurrentIGNO=140
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R003 >=0"',
     *  'at line 163 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00042(I00002,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R003 >=0',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R003 >=0"',
     *  'at line 163 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R003 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00030')
      RETURN
15500 CALL PERETM('S00030',ERRMES)
      RETURN
      END
      SUBROUTINE S00031(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00043,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00043(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R004 >=0"'
      CurrentAction2=
     *  'at line 164 in the TAB file'
      CurrentIGNO=141
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R004 >=0"',
     *  'at line 164 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00043(I00002,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R004 >=0',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R004 >=0"',
     *  'at line 164 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R004 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00031')
      RETURN
15500 CALL PERETM('S00031',ERRMES)
      RETURN
      END
      SUBROUTINE S00032(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00044,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00044(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R005 >=0"'
      CurrentAction2=
     *  'at line 165 in the TAB file'
      CurrentIGNO=142
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R005 >=0"',
     *  'at line 165 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00044(I00002,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R005 >=0',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R005 >=0"',
     *  'at line 165 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R005 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00032')
      RETURN
15500 CALL PERETM('S00032',ERRMES)
      RETURN
      END
      SUBROUTINE S00033(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00045,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00045(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R006 >=0"'
      CurrentAction2=
     *  'at line 166 in the TAB file'
      CurrentIGNO=143
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R006 >=0"',
     *  'at line 166 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00045(I00002,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R006 >=0',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R006 >=0"',
     *  'at line 166 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R006 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00033')
      RETURN
15500 CALL PERETM('S00033',ERRMES)
      RETURN
      END
      SUBROUTINE S00034(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00046,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00046(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R007 >=0"'
      CurrentAction2=
     *  'at line 167 in the TAB file'
      CurrentIGNO=144
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R007 >=0"',
     *  'at line 167 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00046(I00003,I00001).GE.0.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R007 >=0',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R007 >=0"',
     *  'at line 167 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R007 >=0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00034')
      RETURN
15500 CALL PERETM('S00034',ERRMES)
      RETURN
      END
      SUBROUTINE S00035(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00040,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00040(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R001 <=1"'
      CurrentAction2=
     *  'at line 168 in the TAB file'
      CurrentIGNO=145
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R001 <=1"',
     *  'at line 168 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00040(I00003,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R001 <=1',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R001 <=1"',
     *  'at line 168 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R001 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00035')
      RETURN
15500 CALL PERETM('S00035',ERRMES)
      RETURN
      END
      SUBROUTINE S00036(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00041,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00041(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R002 <=1"'
      CurrentAction2=
     *  'at line 169 in the TAB file'
      CurrentIGNO=146
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R002 <=1"',
     *  'at line 169 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00041(I00003,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R002 <=1',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R002 <=1"',
     *  'at line 169 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R002 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00036')
      RETURN
15500 CALL PERETM('S00036',ERRMES)
      RETURN
      END
      SUBROUTINE S00037(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00042,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00042(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R003 <=1"'
      CurrentAction2=
     *  'at line 170 in the TAB file'
      CurrentIGNO=147
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R003 <=1"',
     *  'at line 170 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00042(I00002,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R003 <=1',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R003 <=1"',
     *  'at line 170 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R003 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00037')
      RETURN
15500 CALL PERETM('S00037',ERRMES)
      RETURN
      END
      SUBROUTINE S00038(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00043,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00043(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R004 <=1"'
      CurrentAction2=
     *  'at line 171 in the TAB file'
      CurrentIGNO=148
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R004 <=1"',
     *  'at line 171 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00043(I00002,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R004 <=1',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R004 <=1"',
     *  'at line 171 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R004 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00038')
      RETURN
15500 CALL PERETM('S00038',ERRMES)
      RETURN
      END
      SUBROUTINE S00039(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00044,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00044(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R005 <=1"'
      CurrentAction2=
     *  'at line 172 in the TAB file'
      CurrentIGNO=149
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R005 <=1"',
     *  'at line 172 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00044(I00002,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R005 <=1',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R005 <=1"',
     *  'at line 172 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R005 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00039')
      RETURN
15500 CALL PERETM('S00039',ERRMES)
      RETURN
      END
      SUBROUTINE S00040(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00045,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00045(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R006 <=1"'
      CurrentAction2=
     *  'at line 173 in the TAB file'
      CurrentIGNO=150
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R006 <=1"',
     *  'at line 173 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00045(I00002,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R006 <=1',
     *    I00002,I00001,0,0,0,0,0,
     *    2,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R006 <=1"',
     *  'at line 173 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R006 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00040')
      RETURN
15500 CALL PERETM('S00040',ERRMES)
      RETURN
      END
      SUBROUTINE S00041(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00046,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00046(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "R007 <=1"'
      CurrentAction2=
     *  'at line 174 in the TAB file'
      CurrentIGNO=151
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "R007 <=1"',
     *  'at line 174 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00046(I00003,I00001).LE.1.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,2,
     *'R007 <=1',
     *    I00003,I00001,0,0,0,0,0,
     *    4,1,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "R007 <=1"',
     *  'at line 174 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'R007 <=1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00041')
      RETURN
15500 CALL PERETM('S00041',ERRMES)
      RETURN
      END
      SUBROUTINE M00002(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(115).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1BAS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(115).NE.'n') then
      CALL S00005(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(115),
     *  C00005,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(116).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V2BAS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(116).NE.'n') then
      CALL S00006(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(116),
     *  C00006,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(117).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V3BAS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(117).NE.'n') then
      CALL S00007(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(117),
     *  C00007,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(118).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V4BAS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(118).NE.'n') then
      CALL S00008(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(118),
     *  C00008,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(119).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V5BAS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(119).NE.'n') then
      CALL S00009(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(119),
     *  C00009,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(120).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1MAR >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(120).NE.'n') then
      CALL S00010(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(120),
     *  C00011,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(121).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V2MAR >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(121).NE.'n') then
      CALL S00011(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(121),
     *  C00012,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(122).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V3MAR >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(122).NE.'n') then
      CALL S00012(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(122),
     *  C00013,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(123).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V4MAR >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(123).NE.'n') then
      CALL S00013(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(123),
     *  C00014,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(124).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V5MAR >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(124).NE.'n') then
      CALL S00014(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(124),
     *  C00015,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(125).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1CAP >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(125).NE.'n') then
      CALL S00015(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(125),
     *  C00021,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(126).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1LAB >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(126).NE.'n') then
      CALL S00016(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(126),
     *  C00022,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(127).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1LND >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(127).NE.'n') then
      CALL S00017(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(127),
     *  C00023,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(128).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'MAKE >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(128).NE.'n') then
      CALL S00018(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(128),
     *  C00026,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(129).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA1LAB >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(129).NE.'n') then
      CALL S00019(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(129),
     *  C00028,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(130).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA1PRIM >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(130).NE.'n') then
      CALL S00020(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(130),
     *  C00029,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(131).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA1 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(131).NE.'n') then
      CALL S00021(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(131),
     *  C00030,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(132).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA1OUT >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(132).NE.'n') then
      CALL S00022(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(132),
     *  C00031,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(133).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA2 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(133).NE.'n') then
      CALL S00023(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(133),
     *  C00032,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(134).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SIGMA3 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(134).NE.'n') then
      CALL S00024(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(134),
     *  C00033,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(135).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'EPS >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(135).NE.'n') then
      CALL S00025(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(135),
     *  C00035,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(136).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'IsIndivExp >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(136).NE.'n') then
      CALL S00026(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(136),
     *  C00038,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(137).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'IsLocCom >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(137).NE.'n') then
      CALL S00027(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(137),
     *  C00039,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(138).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R001 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(138).NE.'n') then
      CALL S00028(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(138),
     *  C00040,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(139).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R002 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(139).NE.'n') then
      CALL S00029(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(139),
     *  C00041,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(140).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R003 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(140).NE.'n') then
      CALL S00030(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(140),
     *  C00042,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(141).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R004 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(141).NE.'n') then
      CALL S00031(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(141),
     *  C00043,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(142).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R005 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(142).NE.'n') then
      CALL S00032(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(142),
     *  C00044,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(143).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R006 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(143).NE.'n') then
      CALL S00033(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(143),
     *  C00045,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(144).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R007 >=0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(144).NE.'n') then
      CALL S00034(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(144),
     *  C00046,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(145).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R001 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(145).NE.'n') then
      CALL S00035(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(145),
     *  C00040,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(146).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R002 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(146).NE.'n') then
      CALL S00036(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(146),
     *  C00041,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(147).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R003 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(147).NE.'n') then
      CALL S00037(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(147),
     *  C00042,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(148).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R004 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(148).NE.'n') then
      CALL S00038(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(148),
     *  C00043,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(149).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R005 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(149).NE.'n') then
      CALL S00039(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(149),
     *  C00044,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(150).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R006 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(150).NE.'n') then
      CALL S00040(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(150),
     *  C00045,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(151).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'R007 <=1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(151).NE.'n') then
      CALL S00041(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(151),
     *  C00046,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      RETURN
15000 CALL PERET('M00002')
      RETURN
      END
      SUBROUTINE S00042(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,C00047,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      REAL C00047(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TINY"'
      CurrentAction2=
     *  'at line 177 in the TAB file'
      CurrentIGNO=153
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TINY"',
     *  'at line 177 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS2=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00026(I00002,I00003)
    1 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    2 CONTINUE  ! END SUM(i,IND
      C00047(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TINY"',
     *  'at line 177 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00042')
      RETURN
      END
      SUBROUTINE S00043(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00002,C00047,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00002(1)
      REAL C00047(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TINY"'
      CurrentAction2=
     *  'at line 179 in the TAB file'
      CurrentIGNO=154
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TINY"',
     *  'at line 179 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      RS1=C00047(1)
      RS2=C00002(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE IF(RS1.EQ.0.0) THEN
        RS3=ZDZVAL
        NZDZ=NZDZ+1
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=4
         ErrorDivNo=1
         NumActiveInd=0
         ErrorRVal1=RS1
         ErrorRVal2=RS2
        END IF
      END IF
      C00047(1)=RS3
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TINY"',
     *  'at line 179 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00043')
      RETURN
      END
      SUBROUTINE S00044(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00047,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00047(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TINY"'
      CurrentAction2=
     *  'at line 180 in the TAB file'
      CurrentIGNO=155
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TINY"',
     *  'at line 180 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00047(1)=C00047(1)/10000000 .
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TINY"',
     *  'at line 180 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00044')
      RETURN
      END
      SUBROUTINE S00045(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00011,C00016,C00048,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00016(SSZ(2),SSZ(6),SSZ(4))
      REAL C00048(SSZ(2),SSZ(6),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PUR"'
      CurrentAction2=
     *  'at line 191 in the TAB file'
      CurrentIGNO=162
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PUR"',
     *  'at line 191 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 4 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00011(I00002,I00005,I00003,I00004)
    4 CONTINUE  ! END SUM(m,MAR
      C00048(I00002,I00005,I00003)=C00005(I00002,I00005,I00003)+
     *  C00016(I00002,I00005,I00003)+RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PUR"',
     *  'at line 191 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00045')
      RETURN
      END
      SUBROUTINE S00046(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00006,C00012,C00017,C00049,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      REAL C00012(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00017(SSZ(2),SSZ(6),SSZ(4))
      REAL C00049(SSZ(2),SSZ(6),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2PUR"'
      CurrentAction2=
     *  'at line 194 in the TAB file'
      CurrentIGNO=163
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2PUR"',
     *  'at line 194 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 3 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 4 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00012(I00002,I00005,I00003,I00004)
    4 CONTINUE  ! END SUM(m,MAR
      C00049(I00002,I00005,I00003)=C00006(I00002,I00005,I00003)+
     *  C00017(I00002,I00005,I00003)+RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
    3 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2PUR"',
     *  'at line 194 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00046')
      RETURN
      END
      SUBROUTINE S00047(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00007,C00013,C00018,C00050,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00007(SSZ(2),SSZ(6))
      REAL C00013(SSZ(2),SSZ(6),SSZ(3))
      REAL C00018(SSZ(2),SSZ(6))
      REAL C00050(SSZ(2),SSZ(6))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V3PUR"'
      CurrentAction2=
     *  'at line 196 in the TAB file'
      CurrentIGNO=164
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V3PUR"',
     *  'at line 196 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00013(I00002,I00005,I00004)
    3 CONTINUE  ! END SUM(m,MAR
      C00050(I00002,I00005)=C00007(I00002,I00005)+C00018(I00002,I00005)+
     *  RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V3PUR"',
     *  'at line 196 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00047')
      RETURN
      END
      SUBROUTINE S00048(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00008,C00014,C00019,C00051,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00008(SSZ(2))
      REAL C00014(SSZ(2),SSZ(3))
      REAL C00019(SSZ(2))
      REAL C00051(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V4PUR"'
      CurrentAction2=
     *  'at line 198 in the TAB file'
      CurrentIGNO=165
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V4PUR"',
     *  'at line 198 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00014(I00002,I00004)
    2 CONTINUE  ! END SUM(m,MAR
      C00051(I00002)=C00008(I00002)+C00019(I00002)+RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V4PUR"',
     *  'at line 198 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00048')
      RETURN
      END
      SUBROUTINE S00049(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00009,C00015,C00020,C00052,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00009(SSZ(2),SSZ(6))
      REAL C00015(SSZ(2),SSZ(6),SSZ(3))
      REAL C00020(SSZ(2),SSZ(6))
      REAL C00052(SSZ(2),SSZ(6))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V5PUR"'
      CurrentAction2=
     *  'at line 200 in the TAB file'
      CurrentIGNO=166
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V5PUR"',
     *  'at line 200 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00015(I00002,I00005,I00004)
    3 CONTINUE  ! END SUM(m,MAR
      C00052(I00002,I00005)=C00009(I00002,I00005)+C00020(I00002,I00005)+
     *  RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V5PUR"',
     *  'at line 200 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00049')
      RETURN
      END
      SUBROUTINE S00050(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00022,C00053,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER I00006
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00022(SSZ(4),SSZ(5))
      REAL C00053(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1LAB_O"'
      CurrentAction2=
     *  'at line 204 in the TAB file'
      CurrentIGNO=168
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1LAB_O"',
     *  'at line 204 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00006=1,SSZ(5)  ! SUM(o,OCC
      RS1=RS1+C00022(I00003,I00006)
    2 CONTINUE  ! END SUM(o,OCC
      C00053(I00003)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1LAB_O"',
     *  'at line 204 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00050')
      RETURN
      END
      SUBROUTINE S00051(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,C00023,C00053,C00054,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      REAL C00023(SSZ(4))
      REAL C00053(SSZ(4))
      REAL C00054(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PRIM"'
      CurrentAction2=
     *  'at line 207 in the TAB file'
      CurrentIGNO=170
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PRIM"',
     *  'at line 207 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00054(I00003)=C00053(I00003)+C00021(I00003)+C00023(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PRIM"',
     *  'at line 207 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00051')
      RETURN
      END
      SUBROUTINE S00052(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00048,C00055,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00048(SSZ(2),SSZ(6),SSZ(4))
      REAL C00055(SSZ(2),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PUR_S"'
      CurrentAction2=
     *  'at line 212 in the TAB file'
      CurrentIGNO=174
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PUR_S"',
     *  'at line 212 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS1=RS1+C00048(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(s,SRC
      C00055(I00002,I00003)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PUR_S"',
     *  'at line 212 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00052')
      RETURN
      END
      SUBROUTINE S00053(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00055,C00056,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00055(SSZ(2),SSZ(4))
      REAL C00056(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1MAT"'
      CurrentAction2=
     *  'at line 214 in the TAB file'
      CurrentIGNO=175
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1MAT"',
     *  'at line 214 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00055(I00002,I00003)
    2 CONTINUE  ! END SUM(c,COM
      C00056(I00003)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1MAT"',
     *  'at line 214 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00053')
      RETURN
      END
      SUBROUTINE S00054(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00025,C00054,C00056,C00057,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00025(SSZ(4))
      REAL C00054(SSZ(4))
      REAL C00056(SSZ(4))
      REAL C00057(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1CST"'
      CurrentAction2=
     *  'at line 220 in the TAB file'
      CurrentIGNO=180
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1CST"',
     *  'at line 220 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00057(I00003)=C00054(I00003)+C00025(I00003)+C00056(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1CST"',
     *  'at line 220 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00054')
      RETURN
      END
      SUBROUTINE S00055(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00024,C00057,C00058,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00024(SSZ(4))
      REAL C00057(SSZ(4))
      REAL C00058(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1TOT"'
      CurrentAction2=
     *  'at line 222 in the TAB file'
      CurrentIGNO=181
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1TOT"',
     *  'at line 222 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00058(I00003)=C00057(I00003)+C00024(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1TOT"',
     *  'at line 222 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00055')
      RETURN
      END
      SUBROUTINE S00056(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00024,C00057,C00059,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00024(SSZ(4))
      REAL C00057(SSZ(4))
      REAL C00059(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "PTXRATE"'
      CurrentAction2=
     *  'at line 223 in the TAB file'
      CurrentIGNO=182
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "PTXRATE"',
     *  'at line 223 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=C00024(I00003)
      RS2=C00057(I00003)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='i           '
         ErrorIndVal(1)=I00003
         ErrorIndSetNo(1)=4
        END IF
      END IF
      C00059(I00003)=RS3
    1 CONTINUE  ! END (all,i,IND)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "PTXRATE"',
     *  'at line 223 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00056')
      RETURN
      END
      SUBROUTINE S00057(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,C00060,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      REAL C00060(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MAKE_C"'
      CurrentAction2=
     *  'at line 228 in the TAB file'
      CurrentIGNO=186
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MAKE_C"',
     *  'at line 228 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00026(I00002,I00003)
    2 CONTINUE  ! END SUM(c,COM
      C00060(I00003)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MAKE_C"',
     *  'at line 228 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00057')
      RETURN
      END
      SUBROUTINE S00058(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,C00061,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      REAL C00061(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MAKE_I"'
      CurrentAction2=
     *  'at line 230 in the TAB file'
      CurrentIGNO=187
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MAKE_I"',
     *  'at line 230 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00026(I00002,I00003)
    2 CONTINUE  ! END SUM(i,IND
      C00061(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MAKE_I"',
     *  'at line 230 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00058')
      RETURN
      END
      SUBROUTINE S00059(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00049,C00062,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00049(SSZ(2),SSZ(6),SSZ(4))
      REAL C00062(SSZ(2),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2PUR_S"'
      CurrentAction2=
     *  'at line 233 in the TAB file'
      CurrentIGNO=189
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2PUR_S"',
     *  'at line 233 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00003=1,SSZ(4)  ! (all,i,IND)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS1=RS1+C00049(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(s,SRC
      C00062(I00002,I00003)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2PUR_S"',
     *  'at line 233 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00059')
      RETURN
      END
      SUBROUTINE S00060(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00062,C00063,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00062(SSZ(2),SSZ(4))
      REAL C00063(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2TOT"'
      CurrentAction2=
     *  'at line 236 in the TAB file'
      CurrentIGNO=191
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2TOT"',
     *  'at line 236 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00062(I00002,I00003)
    2 CONTINUE  ! END SUM(c,COM
      C00063(I00003)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2TOT"',
     *  'at line 236 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00060')
      RETURN
      END
      SUBROUTINE S00061(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00050,C00064,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00050(SSZ(2),SSZ(6))
      REAL C00064(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V3PUR_S"'
      CurrentAction2=
     *  'at line 239 in the TAB file'
      CurrentIGNO=193
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V3PUR_S"',
     *  'at line 239 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS1=RS1+C00050(I00002,I00005)
    2 CONTINUE  ! END SUM(s,SRC
      C00064(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V3PUR_S"',
     *  'at line 239 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00061')
      RETURN
      END
      SUBROUTINE S00062(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00064,C00065,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00064(SSZ(2))
      REAL C00065(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V3TOT"'
      CurrentAction2=
     *  'at line 245 in the TAB file'
      CurrentIGNO=197
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V3TOT"',
     *  'at line 245 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00064(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00065(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V3TOT"',
     *  'at line 245 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00062')
      RETURN
      END
      SUBROUTINE S00063(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00064,C00065,C00066,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00064(SSZ(2))
      REAL C00065(1)
      REAL C00066(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "S3_S"'
      CurrentAction2=
     *  'at line 247 in the TAB file'
      CurrentIGNO=198
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "S3_S"',
     *  'at line 247 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=C00064(I00002)
      RS2=C00065(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00066(I00002)=RS3
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "S3_S"',
     *  'at line 247 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00063')
      RETURN
      END
      SUBROUTINE S00064(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00035,C00066,C00067,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00035(SSZ(2))
      REAL C00066(SSZ(2))
      REAL C00067(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EPSTOT"'
      CurrentAction2=
     *  'at line 248 in the TAB file'
      CurrentIGNO=199
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EPSTOT"',
     *  'at line 248 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00066(I00002)*C00035(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00067(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EPSTOT"',
     *  'at line 248 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00064')
      RETURN
      END
      SUBROUTINE S00065(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00035,C00067,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00035(SSZ(2))
      REAL C00067(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EPS"'
      CurrentAction2=
     *  'at line 249 in the TAB file'
      CurrentIGNO=200
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EPS"',
     *  'at line 249 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=C00035(I00002)
      RS2=C00067(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00035(I00002)=RS3
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EPS"',
     *  'at line 249 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00065')
      RETURN
      END
      SUBROUTINE S00066(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00038,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00038(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      LOGICAL RUNTSS,PRELIM,DOPRE,DIDPRE
      INTEGER NSSMP
      COMMON /TGPREI/DOPRE,PRELIM,DIDPRE
      COMMON /TGTPSI/NSSMP,RUNTSS
      IER=0
      CurrentAction=
     *  'formula for set "TRADEXP"'
      CurrentAction2=
     *  'at line 251 in the TAB file'
      CurrentIGNO=203
      CurrentIGTP='st'
      CALL GPAPRW(
     *  ' before calculating formula for set "TRADEXP"',
     *  'at line 251 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IF((PRELIM.OR.POSTSIMPASS2).AND.RUNTSS) THEN
        SSMPST(5)=NSSMP+1
        CALL TGINCP(NSSMP+SSZ(2),DSSMP,'DSSMP',ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00038(I00002).GT.0.5
      IF(LG1) THEN
      IS1=1
      END IF
      SSMP(SSMPST(5)-1+I00002)=IS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for set "TRADEXP"',
     *  'at line 251 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00066')
      RETURN
      END
      SUBROUTINE S00067(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00068,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00007
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00068(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MARSALES"'
      CurrentAction2=
     *  'at line 256 in the TAB file'
      CurrentIGNO=210
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MARSALES"',
     *  'at line 256 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00007=1,SSZ(8)  ! (all,n,NONMAR)
      C00068(SSMP(SSMPST(4)-1+I00007))=0.0
    1 CONTINUE  ! END (all,n,NONMAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MARSALES"',
     *  'at line 256 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00067')
      RETURN
      END
      SUBROUTINE S00068(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00011,C00012,C00013,C00014,C00015,C00068,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00012(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00013(SSZ(2),SSZ(6),SSZ(3))
      REAL C00014(SSZ(2),SSZ(3))
      REAL C00015(SSZ(2),SSZ(6),SSZ(3))
      REAL C00068(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MARSALES"'
      CurrentAction2=
     *  'at line 258 in the TAB file'
      CurrentIGNO=211
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MARSALES"',
     *  'at line 258 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00004=1,SSZ(3)  ! (all,m,MAR)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=0.0
      DO 3 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS3=0.0
      DO 4 I00003=1,SSZ(4)  ! SUM(i,IND
      RS3=RS3+C00011(I00002,I00005,I00003,I00004)+
     *  C00012(I00002,I00005,I00003,I00004)
    4 CONTINUE  ! END SUM(i,IND
      RS2=RS2+C00013(I00002,I00005,I00004)+C00015(I00002,I00005,I00004)+
     *  RS3
    3 CONTINUE  ! END SUM(s,SRC
      RS1=RS1+C00014(I00002,I00004)+RS2
    2 CONTINUE  ! END SUM(c,COM
      C00068(SSMP(SSMPST(3)-1+I00004))=RS1
    1 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MARSALES"',
     *  'at line 258 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00068')
      RETURN
      END
      SUBROUTINE S00069(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 264 in the TAB file'
      CurrentIGNO=214
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 264 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00005(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00069(I00002,I00005,1)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 264 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00069')
      RETURN
      END
      SUBROUTINE S00070(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00006,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 266 in the TAB file'
      CurrentIGNO=215
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 266 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00006(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00069(I00002,I00005,2)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 266 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00070')
      RETURN
      END
      SUBROUTINE S00071(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00007,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00007(SSZ(2),SSZ(6))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 267 in the TAB file'
      CurrentIGNO=216
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 267 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,I00005,3)=C00007(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 267 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00071')
      RETURN
      END
      SUBROUTINE S00072(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00008,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00008(SSZ(2))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 268 in the TAB file'
      CurrentIGNO=217
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 268 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,1,4)=C00008(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 268 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00072')
      RETURN
      END
      SUBROUTINE S00073(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 269 in the TAB file'
      CurrentIGNO=218
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 269 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,2,4)=0
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 269 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00073')
      RETURN
      END
      SUBROUTINE S00074(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00009,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00009(SSZ(2),SSZ(6))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 270 in the TAB file'
      CurrentIGNO=219
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 270 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,I00005,5)=C00009(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 270 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00074')
      RETURN
      END
      SUBROUTINE S00075(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00010,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 271 in the TAB file'
      CurrentIGNO=220
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 271 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,I00005,6)=C00010(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 271 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00075')
      RETURN
      END
      SUBROUTINE S00076(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00068,C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00068(SSZ(2))
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 272 in the TAB file'
      CurrentIGNO=221
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 272 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,1,7)=C00068(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 272 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00076')
      RETURN
      END
      SUBROUTINE S00077(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00069,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALE"'
      CurrentAction2=
     *  'at line 273 in the TAB file'
      CurrentIGNO=222
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALE"',
     *  'at line 273 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00069(I00002,2,7)=0
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALE"',
     *  'at line 273 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00077')
      RETURN
      END
      SUBROUTINE S00078(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00069,C00070,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00008
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      REAL C00070(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0IMP"'
      CurrentAction2=
     *  'at line 276 in the TAB file'
      CurrentIGNO=225
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0IMP"',
     *  'at line 276 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00008=1,SSZ(11)  ! SUM(d,DEST
      RS1=RS1+C00069(I00002,2,I00008)
    2 CONTINUE  ! END SUM(d,DEST
      C00070(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0IMP"',
     *  'at line 276 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00078')
      RETURN
      END
      SUBROUTINE S00079(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00069,C00071,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00008
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00069(SSZ(2),SSZ(6),SSZ(11))
      REAL C00071(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALES"'
      CurrentAction2=
     *  'at line 278 in the TAB file'
      CurrentIGNO=227
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALES"',
     *  'at line 278 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00008=1,SSZ(11)  ! SUM(d,DEST
      RS1=RS1+C00069(I00002,1,I00008)
    2 CONTINUE  ! END SUM(d,DEST
      C00071(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALES"',
     *  'at line 278 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00079')
      RETURN
      END
      SUBROUTINE S00080(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00008,C00071,C00072,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00008(SSZ(2))
      REAL C00071(SSZ(2))
      REAL C00072(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DOMSALES"'
      CurrentAction2=
     *  'at line 280 in the TAB file'
      CurrentIGNO=229
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DOMSALES"',
     *  'at line 280 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00072(I00002)=C00071(I00002)-C00008(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DOMSALES"',
     *  'at line 280 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00080')
      RETURN
      END
      SUBROUTINE M00003(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      IF(ECHO1.AND.DOIG(153).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TINY',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(153).NE.'n') then
      CALL S00042(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(153),
     *  C00026,C00047,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(154).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TINY',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(154).NE.'n') then
      CALL S00043(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(154),
     *  C00002,C00047,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(155).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TINY',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(155).NE.'n') then
      CALL S00044(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(155),
     *  C00047,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(162).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PUR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(162).NE.'n') then
      CALL S00045(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(162),
     *  C00005,C00011,C00016,C00048,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(163).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2PUR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(163).NE.'n') then
      CALL S00046(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(163),
     *  C00006,C00012,C00017,C00049,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(164).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V3PUR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(164).NE.'n') then
      CALL S00047(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(164),
     *  C00007,C00013,C00018,C00050,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(165).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V4PUR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(165).NE.'n') then
      CALL S00048(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(165),
     *  C00008,C00014,C00019,C00051,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(166).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V5PUR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(166).NE.'n') then
      CALL S00049(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(166),
     *  C00009,C00015,C00020,C00052,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(168).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1LAB_O',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(168).NE.'n') then
      CALL S00050(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(168),
     *  C00022,C00053,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(170).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PRIM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(170).NE.'n') then
      CALL S00051(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(170),
     *  C00021,C00023,C00053,C00054,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(.NOT.POSTSIMPASS2.AND.(.NOT.POSTSIMPASS3)) THEN
      ZDZVAL=0.5
      END IF
      IF(ECHO1.AND.DOIG(174).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PUR_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(174).NE.'n') then
      CALL S00052(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(174),
     *  C00048,C00055,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(175).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1MAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(175).NE.'n') then
      CALL S00053(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(175),
     *  C00055,C00056,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(180).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1CST',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(180).NE.'n') then
      CALL S00054(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(180),
     *  C00025,C00054,C00056,C00057,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(181).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(181).NE.'n') then
      CALL S00055(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(181),
     *  C00024,C00057,C00058,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(182).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'PTXRATE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(182).NE.'n') then
      CALL S00056(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(182),
     *  C00024,C00057,C00059,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(186).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MAKE_C',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(186).NE.'n') then
      CALL S00057(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(186),
     *  C00026,C00060,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(187).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MAKE_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(187).NE.'n') then
      CALL S00058(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(187),
     *  C00026,C00061,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(189).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2PUR_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(189).NE.'n') then
      CALL S00059(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(189),
     *  C00049,C00062,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(191).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(191).NE.'n') then
      CALL S00060(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(191),
     *  C00062,C00063,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(193).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V3PUR_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(193).NE.'n') then
      CALL S00061(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(193),
     *  C00050,C00064,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(197).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V3TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(197).NE.'n') then
      CALL S00062(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(197),
     *  C00064,C00065,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(198).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'S3_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(198).NE.'n') then
      CALL S00063(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(198),
     *  C00064,C00065,C00066,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(199).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EPSTOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(199).NE.'n') then
      CALL S00064(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(199),
     *  C00035,C00066,C00067,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(200).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EPS',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(200).NE.'n') then
      CALL S00065(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(200),
     *  C00035,C00067,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(203).EQ.'y') THEN
        CALL GPTO1(' Formula for set ''%t''',
     *    'TRADEXP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(203).NE.'n') then
      CALL S00066(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(203),
     *  C00038,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=9
       SSNO=5
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,5,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=10
       SSNO=6
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,6,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(210).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MARSALES',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(210).NE.'n') then
      CALL S00067(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(210),
     *  C00068,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(211).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MARSALES',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(211).NE.'n') then
      CALL S00068(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(211),
     *  C00011,C00012,C00013,C00014,C00015,C00068,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,69,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(214).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(214).NE.'n') then
      CALL S00069(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(214),
     *  C00005,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(215).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(215).NE.'n') then
      CALL S00070(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(215),
     *  C00006,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(216).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(216).NE.'n') then
      CALL S00071(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(216),
     *  C00007,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(217).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(217).NE.'n') then
      CALL S00072(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(217),
     *  C00008,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(218).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(218).NE.'n') then
      CALL S00073(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(218),
     *  C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(219).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(219).NE.'n') then
      CALL S00074(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(219),
     *  C00009,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(220).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(220).NE.'n') then
      CALL S00075(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(220),
     *  C00010,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(221).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(221).NE.'n') then
      CALL S00076(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(221),
     *  C00068,C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(222).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(222).NE.'n') then
      CALL S00077(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(222),
     *  C00069,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(225).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0IMP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(225).NE.'n') then
      CALL S00078(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(225),
     *  C00069,C00070,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(227).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALES',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(227).NE.'n') then
      CALL S00079(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(227),
     *  C00069,C00071,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(229).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DOMSALES',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(229).NE.'n') then
      CALL S00080(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(229),
     *  C00008,C00071,C00072,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      RETURN
15000 CALL PERET('M00003')
      RETURN
      END
      SUBROUTINE S00081(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00016,C00073,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00016(SSZ(2),SSZ(6),SSZ(4))
      REAL C00073(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1TAX_CSI"'
      CurrentAction2=
     *  'at line 290 in the TAB file'
      CurrentIGNO=238
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1TAX_CSI"',
     *  'at line 290 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS2=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS3=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS3=RS3+C00016(I00002,I00005,I00003)
    1 CONTINUE  ! END SUM(c,COM
      RS2=RS2+RS3
    2 CONTINUE  ! END SUM(s,SRC
      RS1=RS1+RS2
    3 CONTINUE  ! END SUM(i,IND
      C00073(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1TAX_CSI"',
     *  'at line 290 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00081')
      RETURN
      END
      SUBROUTINE S00082(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00017,C00074,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00017(SSZ(2),SSZ(6),SSZ(4))
      REAL C00074(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2TAX_CSI"'
      CurrentAction2=
     *  'at line 292 in the TAB file'
      CurrentIGNO=239
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2TAX_CSI"',
     *  'at line 292 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS2=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS3=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS3=RS3+C00017(I00002,I00005,I00003)
    1 CONTINUE  ! END SUM(c,COM
      RS2=RS2+RS3
    2 CONTINUE  ! END SUM(s,SRC
      RS1=RS1+RS2
    3 CONTINUE  ! END SUM(i,IND
      C00074(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2TAX_CSI"',
     *  'at line 292 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00082')
      RETURN
      END
      SUBROUTINE S00083(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00018,C00075,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00018(SSZ(2),SSZ(6))
      REAL C00075(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V3TAX_CS"'
      CurrentAction2=
     *  'at line 293 in the TAB file'
      CurrentIGNO=240
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V3TAX_CS"',
     *  'at line 293 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS2=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00018(I00002,I00005)
    1 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    2 CONTINUE  ! END SUM(s,SRC
      C00075(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V3TAX_CS"',
     *  'at line 293 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00083')
      RETURN
      END
      SUBROUTINE S00084(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00019,C00076,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00019(SSZ(2))
      REAL C00076(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V4TAX_C"'
      CurrentAction2=
     *  'at line 294 in the TAB file'
      CurrentIGNO=241
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V4TAX_C"',
     *  'at line 294 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00019(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00076(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V4TAX_C"',
     *  'at line 294 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00084')
      RETURN
      END
      SUBROUTINE S00085(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00020,C00077,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00020(SSZ(2),SSZ(6))
      REAL C00077(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V5TAX_CS"'
      CurrentAction2=
     *  'at line 295 in the TAB file'
      CurrentIGNO=242
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V5TAX_CS"',
     *  'at line 295 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS2=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00020(I00002,I00005)
    1 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    2 CONTINUE  ! END SUM(s,SRC
      C00077(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V5TAX_CS"',
     *  'at line 295 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00085')
      RETURN
      END
      SUBROUTINE S00086(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00027,C00078,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00027(SSZ(2))
      REAL C00078(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0TAR_C"'
      CurrentAction2=
     *  'at line 296 in the TAB file'
      CurrentIGNO=243
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0TAR_C"',
     *  'at line 296 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00027(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00078(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0TAR_C"',
     *  'at line 296 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00086')
      RETURN
      END
      SUBROUTINE S00087(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,C00079,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      REAL C00079(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1CAP_I"'
      CurrentAction2=
     *  'at line 306 in the TAB file'
      CurrentIGNO=252
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1CAP_I"',
     *  'at line 306 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00021(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00079(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1CAP_I"',
     *  'at line 306 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00087')
      RETURN
      END
      SUBROUTINE S00088(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00053,C00080,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00053(SSZ(4))
      REAL C00080(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1LAB_IO"'
      CurrentAction2=
     *  'at line 308 in the TAB file'
      CurrentIGNO=253
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1LAB_IO"',
     *  'at line 308 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00053(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00080(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1LAB_IO"',
     *  'at line 308 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00088')
      RETURN
      END
      SUBROUTINE S00089(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00023,C00081,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00023(SSZ(4))
      REAL C00081(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1LND_I"'
      CurrentAction2=
     *  'at line 309 in the TAB file'
      CurrentIGNO=254
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1LND_I"',
     *  'at line 309 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00023(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00081(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1LND_I"',
     *  'at line 309 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00089')
      RETURN
      END
      SUBROUTINE S00090(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00024,C00082,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00024(SSZ(4))
      REAL C00082(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PTX_I"'
      CurrentAction2=
     *  'at line 310 in the TAB file'
      CurrentIGNO=255
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PTX_I"',
     *  'at line 310 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00024(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00082(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PTX_I"',
     *  'at line 310 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00090')
      RETURN
      END
      SUBROUTINE S00091(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00025,C00083,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00025(SSZ(4))
      REAL C00083(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1OCT_I"'
      CurrentAction2=
     *  'at line 311 in the TAB file'
      CurrentIGNO=256
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1OCT_I"',
     *  'at line 311 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00025(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00083(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1OCT_I"',
     *  'at line 311 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00091')
      RETURN
      END
      SUBROUTINE S00092(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00079,C00080,C00081,C00084,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00079(1)
      REAL C00080(1)
      REAL C00081(1)
      REAL C00084(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PRIM_I"'
      CurrentAction2=
     *  'at line 312 in the TAB file'
      CurrentIGNO=257
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PRIM_I"',
     *  'at line 312 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00084(1)=C00080(1)+C00079(1)+C00081(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PRIM_I"',
     *  'at line 312 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00092')
      RETURN
      END
      SUBROUTINE S00093(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00073,C00074,C00075,C00076,C00077,C00078,C00082,C00083,
     *  C00086,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00073(1)
      REAL C00074(1)
      REAL C00075(1)
      REAL C00076(1)
      REAL C00077(1)
      REAL C00078(1)
      REAL C00082(1)
      REAL C00083(1)
      REAL C00086(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0TAX_CSI"'
      CurrentAction2=
     *  'at line 313 in the TAB file'
      CurrentIGNO=258
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0TAX_CSI"',
     *  'at line 313 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00086(1)=C00073(1)+C00074(1)+C00075(1)+C00076(1)+C00077(1)+
     *  C00078(1)+C00083(1)+C00082(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0TAX_CSI"',
     *  'at line 313 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00093')
      RETURN
      END
      SUBROUTINE S00094(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00084,C00085,C00086,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00084(1)
      REAL C00085(1)
      REAL C00086(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0GDPINC"'
      CurrentAction2=
     *  'at line 315 in the TAB file'
      CurrentIGNO=259
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0GDPINC"',
     *  'at line 315 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00085(1)=C00084(1)+C00086(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0GDPINC"',
     *  'at line 315 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00094')
      RETURN
      END
      SUBROUTINE S00095(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00027,C00070,C00087,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00027(SSZ(2))
      REAL C00070(SSZ(2))
      REAL C00087(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0CIF"'
      CurrentAction2=
     *  'at line 327 in the TAB file'
      CurrentIGNO=270
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0CIF"',
     *  'at line 327 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00087(I00002)=C00070(I00002)-C00027(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0CIF"',
     *  'at line 327 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00095')
      RETURN
      END
      SUBROUTINE S00096(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00087,C00088,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00087(SSZ(2))
      REAL C00088(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0CIF_C"'
      CurrentAction2=
     *  'at line 329 in the TAB file'
      CurrentIGNO=271
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0CIF_C"',
     *  'at line 329 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00087(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00088(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0CIF_C"',
     *  'at line 329 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00096')
      RETURN
      END
      SUBROUTINE S00097(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00070,C00089,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00070(SSZ(2))
      REAL C00089(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0IMP_C"'
      CurrentAction2=
     *  'at line 330 in the TAB file'
      CurrentIGNO=272
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0IMP_C"',
     *  'at line 330 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00070(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00089(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0IMP_C"',
     *  'at line 330 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00097')
      RETURN
      END
      SUBROUTINE S00098(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00063,C00090,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00063(SSZ(4))
      REAL C00090(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2TOT_I"'
      CurrentAction2=
     *  'at line 331 in the TAB file'
      CurrentIGNO=273
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2TOT_I"',
     *  'at line 331 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00063(I00003)
    1 CONTINUE  ! END SUM(i,IND
      C00090(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2TOT_I"',
     *  'at line 331 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00098')
      RETURN
      END
      SUBROUTINE S00099(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00051,C00091,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00051(SSZ(2))
      REAL C00091(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V4TOT"'
      CurrentAction2=
     *  'at line 332 in the TAB file'
      CurrentIGNO=274
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V4TOT"',
     *  'at line 332 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00051(I00002)
    1 CONTINUE  ! END SUM(c,COM
      C00091(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V4TOT"',
     *  'at line 332 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00099')
      RETURN
      END
      SUBROUTINE S00100(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00052,C00092,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00052(SSZ(2),SSZ(6))
      REAL C00092(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V5TOT"'
      CurrentAction2=
     *  'at line 333 in the TAB file'
      CurrentIGNO=275
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V5TOT"',
     *  'at line 333 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS2=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00052(I00002,I00005)
    1 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    2 CONTINUE  ! END SUM(s,SRC
      C00092(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V5TOT"',
     *  'at line 333 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00100')
      RETURN
      END
      SUBROUTINE S00101(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00010,C00093,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00093(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V6TOT"'
      CurrentAction2=
     *  'at line 334 in the TAB file'
      CurrentIGNO=276
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V6TOT"',
     *  'at line 334 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS2=0.0
      DO 1 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00010(I00002,I00005)
    1 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    2 CONTINUE  ! END SUM(s,SRC
      C00093(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V6TOT"',
     *  'at line 334 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00101')
      RETURN
      END
      SUBROUTINE S00102(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00065,C00090,C00092,C00093,C00094,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00065(1)
      REAL C00090(1)
      REAL C00092(1)
      REAL C00093(1)
      REAL C00094(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0GNE"'
      CurrentAction2=
     *  'at line 335 in the TAB file'
      CurrentIGNO=277
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0GNE"',
     *  'at line 335 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00094(1)=C00065(1)+C00090(1)+C00092(1)+C00093(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0GNE"',
     *  'at line 335 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00102')
      RETURN
      END
      SUBROUTINE S00103(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00088,C00091,C00094,C00095,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00088(1)
      REAL C00091(1)
      REAL C00094(1)
      REAL C00095(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V0GDPEXP"'
      CurrentAction2=
     *  'at line 336 in the TAB file'
      CurrentIGNO=278
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V0GDPEXP"',
     *  'at line 336 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00095(1)=C00094(1)+C00091(1)-C00088(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V0GDPEXP"',
     *  'at line 336 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00103')
      RETURN
      END
      SUBROUTINE S00104(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00058,C00060,C00096,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00058(SSZ(4))
      REAL C00060(SSZ(4))
      REAL C00096(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DIFFIND"'
      CurrentAction2=
     *  'at line 347 in the TAB file'
      CurrentIGNO=286
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DIFFIND"',
     *  'at line 347 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00096(I00003)=C00058(I00003)-C00060(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DIFFIND"',
     *  'at line 347 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00104')
      RETURN
      END
      SUBROUTINE S00105(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00061,C00071,C00097,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00061(SSZ(2))
      REAL C00071(SSZ(2))
      REAL C00097(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DIFFCOM"'
      CurrentAction2=
     *  'at line 349 in the TAB file'
      CurrentIGNO=287
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DIFFCOM"',
     *  'at line 349 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00097(I00002)=C00071(I00002)-C00061(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DIFFCOM"',
     *  'at line 349 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00105')
      RETURN
      END
      SUBROUTINE S00106(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00058,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00058(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V1TOT>0"'
      CurrentAction2=
     *  'at line 358 in the TAB file'
      CurrentIGNO=294
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V1TOT>0"',
     *  'at line 358 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=C00058(I00003).GT.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'V1TOT>0',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V1TOT>0"',
     *  'at line 358 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V1TOT>0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00106')
      RETURN
15500 CALL PERETM('S00106',ERRMES)
      RETURN
      END
      SUBROUTINE S00107(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00071,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00071(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "SALES>0"'
      CurrentAction2=
     *  'at line 360 in the TAB file'
      CurrentIGNO=295
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "SALES>0"',
     *  'at line 360 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00071(I00002).GT.0
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'SALES>0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "SALES>0"',
     *  'at line 360 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'SALES>0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00107')
      RETURN
15500 CALL PERETM('S00107',ERRMES)
      RETURN
      END
      SUBROUTINE S00108(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00010,C00071,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00071(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "(STOCKS/SALES) <95%"'
      CurrentAction2=
     *  'at line 361 in the TAB file'
      CurrentIGNO=296
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "(STOCKS/SALES) <95%"',
     *  'at line 361 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      RS1=C00010(I00002,1)
      RS2=C00071(I00002)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      LG1=RS3.LT.0.95
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'(STOCKS/SALES) <95%',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "(STOCKS/SALES) <95%"',
     *  'at line 361 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'(STOCKS/SALES) <95%',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00108')
      RETURN
15500 CALL PERETM('S00108',ERRMES)
      RETURN
      END
      SUBROUTINE S00109(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00058,C00096,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00058(SSZ(4))
      REAL C00096(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DIFFIND"'
      CurrentAction2=
     *  'at line 363 in the TAB file'
      CurrentIGNO=297
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DIFFIND"',
     *  'at line 363 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=C00096(I00003)
      RS2=C00058(I00003)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='i           '
         ErrorIndVal(1)=I00003
         ErrorIndSetNo(1)=4
        END IF
      END IF
      C00096(I00003)=RS3
    1 CONTINUE  ! END (all,i,IND)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DIFFIND"',
     *  'at line 363 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00109')
      RETURN
      END
      SUBROUTINE S00110(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00071,C00097,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00071(SSZ(2))
      REAL C00097(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DIFFCOM"'
      CurrentAction2=
     *  'at line 365 in the TAB file'
      CurrentIGNO=298
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DIFFCOM"',
     *  'at line 365 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=C00097(I00002)
      RS2=C00071(I00002)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00097(I00002)=RS3
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DIFFCOM"',
     *  'at line 365 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00110')
      RETURN
      END
      SUBROUTINE S00111(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00096,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00096(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "DIFFIND = V1TOT-MAKE_C = tiny"'
      CurrentAction2=
     *  'at line 369 in the TAB file'
      CurrentIGNO=301
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "DIFFIND = V1TOT-MAKE_C = tiny"',
     *  'at line 369 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      LG1=ABS(REAL(C00096(I00003))).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'DIFFIND = V1TOT-MAKE_C = tiny',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "DIFFIND = V1TOT-MAKE_C = tiny"',
     *  'at line 369 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'DIFFIND = V1TOT-MAKE_C = tiny',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00111')
      RETURN
15500 CALL PERETM('S00111',ERRMES)
      RETURN
      END
      SUBROUTINE S00112(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00097,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00097(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "DIFFCOM = SALES-MAKE_I = tiny"'
      CurrentAction2=
     *  'at line 371 in the TAB file'
      CurrentIGNO=302
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "DIFFCOM = SALES-MAKE_I = tiny"',
     *  'at line 371 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=ABS(REAL(C00097(I00002))).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'DIFFCOM = SALES-MAKE_I = tiny',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "DIFFCOM = SALES-MAKE_I = tiny"',
     *  'at line 371 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'DIFFCOM = SALES-MAKE_I = tiny',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00112')
      RETURN
15500 CALL PERETM('S00112',ERRMES)
      RETURN
      END
      SUBROUTINE S00113(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00067,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00067(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Average Engel elasticity = 1"'
      CurrentAction2=
     *  'at line 372 in the TAB file'
      CurrentIGNO=303
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Average Engel elasticity = 1"',
     *  'at line 372 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      IS1=0
      LG1=ABS(REAL(1  -C00067(1))).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,0,
     *'Average Engel elasticity = 1',
     *    0,0,0,0,0,0,0,
     *    0,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Average Engel elasticity = 1"',
     *  'at line 372 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Average Engel elasticity = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00113')
      RETURN
15500 CALL PERETM('S00113',ERRMES)
      RETURN
      END
      SUBROUTINE S00114(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00065,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00065(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 374 in the TAB file'
      CurrentIGNO=305
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 374 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(1)=C00065(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 374 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00114')
      RETURN
      END
      SUBROUTINE M00004(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=12
       SSNO=7
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,7,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(238).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1TAX_CSI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(238).NE.'n') then
      CALL S00081(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(238),
     *  C00016,C00073,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(239).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2TAX_CSI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(239).NE.'n') then
      CALL S00082(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(239),
     *  C00017,C00074,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(240).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V3TAX_CS',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(240).NE.'n') then
      CALL S00083(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(240),
     *  C00018,C00075,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(241).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V4TAX_C',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(241).NE.'n') then
      CALL S00084(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(241),
     *  C00019,C00076,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(242).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V5TAX_CS',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(242).NE.'n') then
      CALL S00085(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(242),
     *  C00020,C00077,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(243).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0TAR_C',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(243).NE.'n') then
      CALL S00086(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(243),
     *  C00027,C00078,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(252).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1CAP_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(252).NE.'n') then
      CALL S00087(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(252),
     *  C00021,C00079,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(253).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1LAB_IO',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(253).NE.'n') then
      CALL S00088(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(253),
     *  C00053,C00080,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(254).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1LND_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(254).NE.'n') then
      CALL S00089(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(254),
     *  C00023,C00081,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(255).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PTX_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(255).NE.'n') then
      CALL S00090(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(255),
     *  C00024,C00082,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(256).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1OCT_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(256).NE.'n') then
      CALL S00091(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(256),
     *  C00025,C00083,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(257).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PRIM_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(257).NE.'n') then
      CALL S00092(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(257),
     *  C00079,C00080,C00081,C00084,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(258).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0TAX_CSI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(258).NE.'n') then
      CALL S00093(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(258),
     *  C00073,C00074,C00075,C00076,C00077,C00078,C00082,C00083,
     *  C00086,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(259).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0GDPINC',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(259).NE.'n') then
      CALL S00094(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(259),
     *  C00084,C00085,C00086,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(270).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0CIF',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(270).NE.'n') then
      CALL S00095(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(270),
     *  C00027,C00070,C00087,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(271).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0CIF_C',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(271).NE.'n') then
      CALL S00096(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(271),
     *  C00087,C00088,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(272).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0IMP_C',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(272).NE.'n') then
      CALL S00097(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(272),
     *  C00070,C00089,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(273).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2TOT_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(273).NE.'n') then
      CALL S00098(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(273),
     *  C00063,C00090,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(274).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V4TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(274).NE.'n') then
      CALL S00099(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(274),
     *  C00051,C00091,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(275).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V5TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(275).NE.'n') then
      CALL S00100(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(275),
     *  C00052,C00092,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(276).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V6TOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(276).NE.'n') then
      CALL S00101(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(276),
     *  C00010,C00093,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(277).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0GNE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(277).NE.'n') then
      CALL S00102(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(277),
     *  C00065,C00090,C00092,C00093,C00094,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(278).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V0GDPEXP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(278).NE.'n') then
      CALL S00103(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(278),
     *  C00088,C00091,C00094,C00095,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=11
       SSNO=8
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,8,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,98,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(286).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DIFFIND',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(286).NE.'n') then
      CALL S00104(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(286),
     *  C00058,C00060,C00096,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(287).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DIFFCOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(287).NE.'n') then
      CALL S00105(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(287),
     *  C00061,C00071,C00097,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(294).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V1TOT>0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(294).NE.'n') then
      CALL S00106(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(294),
     *  C00058,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(295).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'SALES>0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(295).NE.'n') then
      CALL S00107(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(295),
     *  C00071,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(296).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  '(STOCKS/SALES) <95%',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(296).NE.'n') then
      CALL S00108(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(296),
     *  C00010,C00071,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(297).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DIFFIND',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(297).NE.'n') then
      CALL S00109(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(297),
     *  C00058,C00096,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(298).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DIFFCOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(298).NE.'n') then
      CALL S00110(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(298),
     *  C00071,C00097,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(301).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'DIFFIND = V1TOT-MAKE_C = tiny',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(301).NE.'n') then
      CALL S00111(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(301),
     *  C00096,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(302).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'DIFFCOM = SALES-MAKE_I = tiny',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(302).NE.'n') then
      CALL S00112(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(302),
     *  C00097,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(303).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Average Engel elasticity = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(303).NE.'n') then
      CALL S00113(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(303),
     *  C00067,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(305).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(305).NE.'n') then
      CALL S00114(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(305),
     *  C00065,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      RETURN
15000 CALL PERET('M00004')
      RETURN
      END
      SUBROUTINE S00115(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00090,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00090(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 376 in the TAB file'
      CurrentIGNO=306
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 376 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(2)=C00090(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 376 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00115')
      RETURN
      END
      SUBROUTINE S00116(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00092,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00092(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 377 in the TAB file'
      CurrentIGNO=307
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 377 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(3)=C00092(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 377 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00116')
      RETURN
      END
      SUBROUTINE S00117(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00093,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00093(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 378 in the TAB file'
      CurrentIGNO=308
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 378 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(4)=C00093(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 378 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00117')
      RETURN
      END
      SUBROUTINE S00118(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00091,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00091(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 379 in the TAB file'
      CurrentIGNO=309
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 379 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(5)=C00091(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 379 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00118')
      RETURN
      END
      SUBROUTINE S00119(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00088,C00098,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00088(1)
      REAL C00098(SSZ(14))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "EXPGDP"'
      CurrentAction2=
     *  'at line 380 in the TAB file'
      CurrentIGNO=310
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "EXPGDP"',
     *  'at line 380 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00098(6)=-C00088(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "EXPGDP"',
     *  'at line 380 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00119')
      RETURN
      END
      SUBROUTINE S00120(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00081,C00099,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00081(1)
      REAL C00099(SSZ(15))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "INCGDP"'
      CurrentAction2=
     *  'at line 385 in the TAB file'
      CurrentIGNO=314
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "INCGDP"',
     *  'at line 385 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00099(1)=C00081(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "INCGDP"',
     *  'at line 385 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00120')
      RETURN
      END
      SUBROUTINE S00121(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00080,C00099,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00080(1)
      REAL C00099(SSZ(15))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "INCGDP"'
      CurrentAction2=
     *  'at line 387 in the TAB file'
      CurrentIGNO=315
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "INCGDP"',
     *  'at line 387 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00099(2)=C00080(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "INCGDP"',
     *  'at line 387 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00121')
      RETURN
      END
      SUBROUTINE S00122(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00079,C00099,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00079(1)
      REAL C00099(SSZ(15))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "INCGDP"'
      CurrentAction2=
     *  'at line 388 in the TAB file'
      CurrentIGNO=316
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "INCGDP"',
     *  'at line 388 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00099(3)=C00079(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "INCGDP"',
     *  'at line 388 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00122')
      RETURN
      END
      SUBROUTINE S00123(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00086,C00099,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00086(1)
      REAL C00099(SSZ(15))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "INCGDP"'
      CurrentAction2=
     *  'at line 389 in the TAB file'
      CurrentIGNO=317
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "INCGDP"',
     *  'at line 389 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00099(4)=C00086(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "INCGDP"',
     *  'at line 389 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00123')
      RETURN
      END
      SUBROUTINE S00124(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00073,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00073(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 394 in the TAB file'
      CurrentIGNO=321
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 394 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(1)=C00073(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 394 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00124')
      RETURN
      END
      SUBROUTINE S00125(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00074,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00074(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 396 in the TAB file'
      CurrentIGNO=322
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 396 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(2)=C00074(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 396 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00125')
      RETURN
      END
      SUBROUTINE S00126(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00075,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00075(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 397 in the TAB file'
      CurrentIGNO=323
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 397 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(3)=C00075(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 397 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00126')
      RETURN
      END
      SUBROUTINE S00127(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00076,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00076(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 398 in the TAB file'
      CurrentIGNO=324
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 398 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(4)=C00076(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 398 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00127')
      RETURN
      END
      SUBROUTINE S00128(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00077,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00077(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 399 in the TAB file'
      CurrentIGNO=325
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 399 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(5)=C00077(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 399 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00128')
      RETURN
      END
      SUBROUTINE S00129(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00083,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00083(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 400 in the TAB file'
      CurrentIGNO=326
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 400 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(6)=C00083(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 400 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00129')
      RETURN
      END
      SUBROUTINE S00130(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00082,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00082(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 401 in the TAB file'
      CurrentIGNO=327
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 401 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(7)=C00082(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 401 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00130')
      RETURN
      END
      SUBROUTINE S00131(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00078,C00100,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00078(1)
      REAL C00100(SSZ(16))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TAX"'
      CurrentAction2=
     *  'at line 402 in the TAB file'
      CurrentIGNO=328
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TAX"',
     *  'at line 402 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      C00100(8)=C00078(1)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TAX"',
     *  'at line 402 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00131')
      RETURN
      END
      SUBROUTINE S00132(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 407 in the TAB file'
      CurrentIGNO=332
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 407 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00005(I00002,1,I00003)
    2 CONTINUE  ! END SUM(c,COM
      C00101(I00003,1)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 407 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00132')
      RETURN
      END
      SUBROUTINE S00133(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 409 in the TAB file'
      CurrentIGNO=333
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 409 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00005(I00002,2,I00003)
    2 CONTINUE  ! END SUM(c,COM
      C00101(I00003,2)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 409 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00133')
      RETURN
      END
      SUBROUTINE S00134(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00011,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 410 in the TAB file'
      CurrentIGNO=334
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 410 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 4 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS2=0.0
      DO 3 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS3=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS3=RS3+C00011(I00002,I00005,I00003,I00004)
    2 CONTINUE  ! END SUM(c,COM
      RS2=RS2+RS3
    3 CONTINUE  ! END SUM(s,SRC
      RS1=RS1+RS2
    4 CONTINUE  ! END SUM(m,MAR
      C00101(I00003,3)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 410 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00134')
      RETURN
      END
      SUBROUTINE S00135(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00016,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00016(SSZ(2),SSZ(6),SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 412 in the TAB file'
      CurrentIGNO=335
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 412 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=0.0
      DO 3 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS2=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00016(I00002,I00005,I00003)
    2 CONTINUE  ! END SUM(c,COM
      RS1=RS1+RS2
    3 CONTINUE  ! END SUM(s,SRC
      C00101(I00003,4)=RS1
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 412 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00135')
      RETURN
      END
      SUBROUTINE S00136(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00053,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00053(SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 413 in the TAB file'
      CurrentIGNO=336
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 413 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00101(I00003,5)=C00053(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 413 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00136')
      RETURN
      END
      SUBROUTINE S00137(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 414 in the TAB file'
      CurrentIGNO=337
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 414 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00101(I00003,6)=C00021(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 414 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00137')
      RETURN
      END
      SUBROUTINE S00138(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00023,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00023(SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 415 in the TAB file'
      CurrentIGNO=338
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 415 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00101(I00003,7)=C00023(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 415 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00138')
      RETURN
      END
      SUBROUTINE S00139(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00024,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00024(SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 416 in the TAB file'
      CurrentIGNO=339
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 416 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00101(I00003,8)=C00024(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 416 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00139')
      RETURN
      END
      SUBROUTINE S00140(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00025,C00101,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00025(SSZ(4))
      REAL C00101(SSZ(4),SSZ(17))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "COSTMAT"'
      CurrentAction2=
     *  'at line 417 in the TAB file'
      CurrentIGNO=340
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "COSTMAT"',
     *  'at line 417 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00101(I00003,9)=C00025(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "COSTMAT"',
     *  'at line 417 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00140')
      RETURN
      END
      SUBROUTINE S00141(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER I00012
      INTEGER I00013
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 425 in the TAB file'
      CurrentIGNO=345
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 425 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 4 I00013=1,SSZ(18)  ! (all,sa,SALECAT2)
      DO 3 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 2 I00012=1,SSZ(19)  ! (all,f,FLOWTYPE)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,I00012,I00005,I00013)=0
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,f,FLOWTYPE)
    3 CONTINUE  ! END (all,s,SRC)
    4 CONTINUE  ! END (all,sa,SALECAT2)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 425 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00141')
      RETURN
      END
      SUBROUTINE S00142(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 427 in the TAB file'
      CurrentIGNO=346
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 427 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00005(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00102(I00002,1,I00005,1)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 427 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00142')
      RETURN
      END
      SUBROUTINE S00143(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00016,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00016(SSZ(2),SSZ(6),SSZ(4))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 428 in the TAB file'
      CurrentIGNO=347
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 428 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00016(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00102(I00002,3,I00005,1)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 428 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00143')
      RETURN
      END
      SUBROUTINE S00144(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00011,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 429 in the TAB file'
      CurrentIGNO=348
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 429 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 4 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS2=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS2=RS2+C00011(I00002,I00005,I00003,I00004)
    3 CONTINUE  ! END SUM(i,IND
      RS1=RS1+RS2
    4 CONTINUE  ! END SUM(m,MAR
      C00102(I00002,2,I00005,1)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 429 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00144')
      RETURN
      END
      SUBROUTINE S00145(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00006,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 431 in the TAB file'
      CurrentIGNO=349
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 431 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00006(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00102(I00002,1,I00005,2)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 431 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00145')
      RETURN
      END
      SUBROUTINE S00146(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00017,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00017(SSZ(2),SSZ(6),SSZ(4))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 432 in the TAB file'
      CurrentIGNO=350
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 432 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00017(I00002,I00005,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00102(I00002,3,I00005,2)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 432 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00146')
      RETURN
      END
      SUBROUTINE S00147(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00012,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2
      LOGICAL ECHO1
      REAL C00012(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 433 in the TAB file'
      CurrentIGNO=351
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 433 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 4 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS2=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS2=RS2+C00012(I00002,I00005,I00003,I00004)
    3 CONTINUE  ! END SUM(i,IND
      RS1=RS1+RS2
    4 CONTINUE  ! END SUM(m,MAR
      C00102(I00002,2,I00005,2)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 433 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00147')
      RETURN
      END
      SUBROUTINE S00148(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00007,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00007(SSZ(2),SSZ(6))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 435 in the TAB file'
      CurrentIGNO=352
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 435 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,1,I00005,3)=C00007(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 435 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00148')
      RETURN
      END
      SUBROUTINE S00149(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00018,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00018(SSZ(2),SSZ(6))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 436 in the TAB file'
      CurrentIGNO=353
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 436 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,3,I00005,3)=C00018(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 436 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00149')
      RETURN
      END
      SUBROUTINE S00150(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00013,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00013(SSZ(2),SSZ(6),SSZ(3))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 437 in the TAB file'
      CurrentIGNO=354
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 437 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00013(I00002,I00005,I00004)
    3 CONTINUE  ! END SUM(m,MAR
      C00102(I00002,2,I00005,3)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 437 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00150')
      RETURN
      END
      SUBROUTINE S00151(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00009,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00009(SSZ(2),SSZ(6))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 438 in the TAB file'
      CurrentIGNO=355
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 438 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,1,I00005,5)=C00009(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 438 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00151')
      RETURN
      END
      SUBROUTINE S00152(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00020,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00020(SSZ(2),SSZ(6))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 439 in the TAB file'
      CurrentIGNO=356
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 439 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,3,I00005,5)=C00020(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 439 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00152')
      RETURN
      END
      SUBROUTINE S00153(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00015,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00015(SSZ(2),SSZ(6),SSZ(3))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 440 in the TAB file'
      CurrentIGNO=357
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 440 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00015(I00002,I00005,I00004)
    3 CONTINUE  ! END SUM(m,MAR
      C00102(I00002,2,I00005,5)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 440 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00153')
      RETURN
      END
      SUBROUTINE S00154(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00008,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00008(SSZ(2))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 441 in the TAB file'
      CurrentIGNO=358
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 441 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,1,1,4)=C00008(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 441 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00154')
      RETURN
      END
      SUBROUTINE S00155(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00019,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00019(SSZ(2))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 442 in the TAB file'
      CurrentIGNO=359
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 442 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,3,1,4)=C00019(I00002)
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 442 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00155')
      RETURN
      END
      SUBROUTINE M00005(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      IF(ECHO1.AND.DOIG(306).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(306).NE.'n') then
      CALL S00115(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(306),
     *  C00090,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(307).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(307).NE.'n') then
      CALL S00116(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(307),
     *  C00092,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(308).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(308).NE.'n') then
      CALL S00117(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(308),
     *  C00093,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(309).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(309).NE.'n') then
      CALL S00118(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(309),
     *  C00091,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(310).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'EXPGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(310).NE.'n') then
      CALL S00119(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(310),
     *  C00088,C00098,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,99,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(314).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'INCGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(314).NE.'n') then
      CALL S00120(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(314),
     *  C00081,C00099,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(315).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'INCGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(315).NE.'n') then
      CALL S00121(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(315),
     *  C00080,C00099,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(316).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'INCGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(316).NE.'n') then
      CALL S00122(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(316),
     *  C00079,C00099,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(317).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'INCGDP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(317).NE.'n') then
      CALL S00123(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(317),
     *  C00086,C00099,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,100,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(321).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(321).NE.'n') then
      CALL S00124(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(321),
     *  C00073,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(322).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(322).NE.'n') then
      CALL S00125(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(322),
     *  C00074,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(323).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(323).NE.'n') then
      CALL S00126(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(323),
     *  C00075,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(324).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(324).NE.'n') then
      CALL S00127(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(324),
     *  C00076,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(325).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(325).NE.'n') then
      CALL S00128(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(325),
     *  C00077,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(326).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(326).NE.'n') then
      CALL S00129(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(326),
     *  C00083,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(327).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(327).NE.'n') then
      CALL S00130(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(327),
     *  C00082,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(328).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TAX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(328).NE.'n') then
      CALL S00131(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(328),
     *  C00078,C00100,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,101,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(332).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(332).NE.'n') then
      CALL S00132(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(332),
     *  C00005,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(333).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(333).NE.'n') then
      CALL S00133(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(333),
     *  C00005,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(334).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(334).NE.'n') then
      CALL S00134(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(334),
     *  C00011,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(335).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(335).NE.'n') then
      CALL S00135(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(335),
     *  C00016,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(336).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(336).NE.'n') then
      CALL S00136(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(336),
     *  C00053,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(337).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(337).NE.'n') then
      CALL S00137(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(337),
     *  C00021,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(338).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(338).NE.'n') then
      CALL S00138(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(338),
     *  C00023,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(339).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(339).NE.'n') then
      CALL S00139(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(339),
     *  C00024,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(340).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'COSTMAT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(340).NE.'n') then
      CALL S00140(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(340),
     *  C00025,C00101,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,102,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(345).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(345).NE.'n') then
      CALL S00141(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(345),
     *  C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(346).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(346).NE.'n') then
      CALL S00142(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(346),
     *  C00005,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(347).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(347).NE.'n') then
      CALL S00143(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(347),
     *  C00016,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(348).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(348).NE.'n') then
      CALL S00144(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(348),
     *  C00011,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(349).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(349).NE.'n') then
      CALL S00145(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(349),
     *  C00006,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(350).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(350).NE.'n') then
      CALL S00146(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(350),
     *  C00017,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(351).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(351).NE.'n') then
      CALL S00147(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(351),
     *  C00012,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(352).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(352).NE.'n') then
      CALL S00148(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(352),
     *  C00007,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(353).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(353).NE.'n') then
      CALL S00149(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(353),
     *  C00018,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(354).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(354).NE.'n') then
      CALL S00150(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(354),
     *  C00013,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(355).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(355).NE.'n') then
      CALL S00151(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(355),
     *  C00009,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(356).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(356).NE.'n') then
      CALL S00152(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(356),
     *  C00020,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(357).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(357).NE.'n') then
      CALL S00153(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(357),
     *  C00015,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(358).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(358).NE.'n') then
      CALL S00154(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(358),
     *  C00008,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(359).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(359).NE.'n') then
      CALL S00155(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(359),
     *  C00019,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      RETURN
15000 CALL PERET('M00005')
      RETURN
      END
      SUBROUTINE S00156(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00014,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00014(SSZ(2),SSZ(3))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 443 in the TAB file'
      CurrentIGNO=360
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 443 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00004=1,SSZ(3)  ! SUM(m,MAR
      RS1=RS1+C00014(I00002,I00004)
    2 CONTINUE  ! END SUM(m,MAR
      C00102(I00002,2,1,4)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 443 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00156')
      RETURN
      END
      SUBROUTINE S00157(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00010,C00102,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00102(SSZ(2),SSZ(19),SSZ(6),SSZ(18))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SALEMAT2"'
      CurrentAction2=
     *  'at line 444 in the TAB file'
      CurrentIGNO=361
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SALEMAT2"',
     *  'at line 444 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00102(I00002,1,I00005,6)=C00010(I00002,I00005)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SALEMAT2"',
     *  'at line 444 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00157')
      RETURN
      END
      SUBROUTINE S00158(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00070,C00072,C00103,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00070(SSZ(2))
      REAL C00072(SSZ(2))
      REAL C00103(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "IMPSHR"'
      CurrentAction2=
     *  'at line 447 in the TAB file'
      CurrentIGNO=364
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "IMPSHR"',
     *  'at line 447 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=C00070(I00002)
      RS2=C00072(I00002)+C00070(I00002)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00103(I00002)=RS3
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "IMPSHR"',
     *  'at line 447 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00158')
      RETURN
      END
      SUBROUTINE S00159(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,C00023,C00029,C00053,C00054,C00058,C00104,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      REAL C00023(SSZ(4))
      REAL C00029(SSZ(4))
      REAL C00053(SSZ(4))
      REAL C00054(SSZ(4))
      REAL C00058(SSZ(4))
      REAL C00104(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SUPPLYELAST"'
      CurrentAction2=
     *  'at line 452 in the TAB file'
      CurrentIGNO=369
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SUPPLYELAST"',
     *  'at line 452 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=C00029(I00003)*C00053(I00003)*C00058(I00003)
      RS2=C00054(I00003)*(C00021(I00003)+C00023(I00003))
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE IF(RS1.EQ.0.0) THEN
        RS3=ZDZVAL
        NZDZ=NZDZ+1
      ELSE
        RS3=NDZVAL
        NNDZ=NNDZ+1
      END IF
      C00104(I00003)=RS3
    1 CONTINUE  ! END (all,i,IND)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SUPPLYELAST"',
     *  'at line 452 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00159')
      RETURN
      END
      SUBROUTINE S00160(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00053,C00105,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00053(SSZ(4))
      REAL C00105(SSZ(4),SSZ(20))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "FACTOR"'
      CurrentAction2=
     *  'at line 459 in the TAB file'
      CurrentIGNO=375
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "FACTOR"',
     *  'at line 459 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00105(I00003,1)=C00053(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "FACTOR"',
     *  'at line 459 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00160')
      RETURN
      END
      SUBROUTINE S00161(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00021,C00105,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00021(SSZ(4))
      REAL C00105(SSZ(4),SSZ(20))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "FACTOR"'
      CurrentAction2=
     *  'at line 461 in the TAB file'
      CurrentIGNO=376
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "FACTOR"',
     *  'at line 461 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00105(I00003,2)=C00021(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "FACTOR"',
     *  'at line 461 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00161')
      RETURN
      END
      SUBROUTINE S00162(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00023,C00105,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00023(SSZ(4))
      REAL C00105(SSZ(4),SSZ(20))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "FACTOR"'
      CurrentAction2=
     *  'at line 462 in the TAB file'
      CurrentIGNO=377
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "FACTOR"',
     *  'at line 462 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00105(I00003,3)=C00023(I00003)
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "FACTOR"',
     *  'at line 462 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00162')
      RETURN
      END
      SUBROUTINE S00163(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00055,C00106,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00055(SSZ(2),SSZ(4))
      REAL C00106(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V1PUR_SI"'
      CurrentAction2=
     *  'at line 468 in the TAB file'
      CurrentIGNO=383
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V1PUR_SI"',
     *  'at line 468 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00055(I00002,I00003)
    2 CONTINUE  ! END SUM(i,IND
      C00106(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V1PUR_SI"',
     *  'at line 468 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00163')
      RETURN
      END
      SUBROUTINE S00164(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00062,C00107,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00062(SSZ(2),SSZ(4))
      REAL C00107(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V2PUR_SI"'
      CurrentAction2=
     *  'at line 469 in the TAB file'
      CurrentIGNO=384
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V2PUR_SI"',
     *  'at line 469 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00062(I00002,I00003)
    2 CONTINUE  ! END SUM(i,IND
      C00107(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V2PUR_SI"',
     *  'at line 469 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00164')
      RETURN
      END
      SUBROUTINE S00165(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00052,C00108,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00052(SSZ(2),SSZ(6))
      REAL C00108(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V5PUR_S"'
      CurrentAction2=
     *  'at line 470 in the TAB file'
      CurrentIGNO=385
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V5PUR_S"',
     *  'at line 470 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS1=RS1+C00052(I00002,I00005)
    2 CONTINUE  ! END SUM(s,SRC
      C00108(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V5PUR_S"',
     *  'at line 470 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00165')
      RETURN
      END
      SUBROUTINE S00166(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00010,C00109,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00109(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "V6BAS_S"'
      CurrentAction2=
     *  'at line 471 in the TAB file'
      CurrentIGNO=386
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "V6BAS_S"',
     *  'at line 471 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS1=RS1+C00010(I00002,I00005)
    2 CONTINUE  ! END SUM(s,SRC
      C00109(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "V6BAS_S"',
     *  'at line 471 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00166')
      RETURN
      END
      SUBROUTINE S00167(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00110,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00110(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TARFRATE"'
      CurrentAction2=
     *  'at line 480 in the TAB file'
      CurrentIGNO=394
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TARFRATE"',
     *  'at line 480 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00110(I00002)=0
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TARFRATE"',
     *  'at line 480 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00167')
      RETURN
      END
      SUBROUTINE S00168(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00027,C00087,C00110,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL LG1
      LOGICAL ECHO1
      REAL C00027(SSZ(2))
      REAL C00087(SSZ(2))
      REAL C00110(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TARFRATE"'
      CurrentAction2=
     *  'at line 481 in the TAB file'
      CurrentIGNO=395
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TARFRATE"',
     *  'at line 481 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM:)
      LG1=C00087(I00002).GT.0
      IF(LG1) THEN
      RS1=C00027(I00002)
      RS2=C00087(I00002)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00110(I00002)=RS3
      END IF ! IF(LG1) THEN
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TARFRATE"',
     *  'at line 481 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00168')
      RETURN
      END
      SUBROUTINE S00169(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00027,C00087,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1,LG2
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00027(SSZ(2))
      REAL C00087(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "V0CIF>0 if V0TAR<>0"'
      CurrentAction2=
     *  'at line 491 in the TAB file'
      CurrentIGNO=404
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "V0CIF>0 if V0TAR<>0"',
     *  'at line 491 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM:)
      LG1=C00027(I00002).NE.0
      IF(LG1) THEN
      IS1=0
      LG2=C00087(I00002).GT.0
      IF(LG2) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'V0CIF>0 if V0TAR<>0',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
      END IF ! IF(LG1) THEN
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "V0CIF>0 if V0TAR<>0"',
     *  'at line 491 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'V0CIF>0 if V0TAR<>0',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00169')
      RETURN
15500 CALL PERETM('S00169',ERRMES)
      RETURN
      END
      SUBROUTINE S00170(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00039,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00039(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      LOGICAL RUNTSS,PRELIM,DOPRE,DIDPRE
      INTEGER NSSMP
      COMMON /TGPREI/DOPRE,PRELIM,DIDPRE
      COMMON /TGTPSI/NSSMP,RUNTSS
      IER=0
      CurrentAction=
     *  'formula for set "LOCCOM"'
      CurrentAction2=
     *  'at line 493 in the TAB file'
      CurrentIGNO=406
      CurrentIGTP='st'
      CALL GPAPRW(
     *  ' before calculating formula for set "LOCCOM"',
     *  'at line 493 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IF((PRELIM.OR.POSTSIMPASS2).AND.RUNTSS) THEN
        SSMPST(9)=NSSMP+1
        CALL TGINCP(NSSMP+SSZ(2),DSSMP,'DSSMP',ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00039(I00002).GT.0.5
      IF(LG1) THEN
      IS1=1
      END IF
      SSMP(SSMPST(9)-1+I00002)=IS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for set "LOCCOM"',
     *  'at line 493 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00170')
      RETURN
      END
      SUBROUTINE S00171(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3,RS4,RS5
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      LOGICAL RUNTSS,PRELIM,DOPRE,DIDPRE
      INTEGER NSSMP
      COMMON /TGPREI/DOPRE,PRELIM,DIDPRE
      COMMON /TGTPSI/NSSMP,RUNTSS
      IER=0
      CurrentAction=
     *  'formula for set "LOCIND"'
      CurrentAction2=
     *  'at line 496 in the TAB file'
      CurrentIGNO=411
      CurrentIGTP='st'
      CALL GPAPRW(
     *  ' before calculating formula for set "LOCIND"',
     *  'at line 496 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      IF((PRELIM.OR.POSTSIMPASS2).AND.RUNTSS) THEN
        SSMPST(11)=NSSMP+1
        CALL TGINCP(NSSMP+SSZ(4),DSSMP,'DSSMP',ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      RS1=0.0
      DO 2 I00002=1,SSZ(21)  ! SUM(c,LOCCOM
      RS1=RS1+C00026(SSMP(SSMPST(9)-1+I00002),I00003)
    2 CONTINUE  ! END SUM(c,LOCCOM
      RS2=0.0
      DO 3 I00002=1,SSZ(2)  ! SUM(c,COM
      RS2=RS2+C00026(I00002,I00003)
    3 CONTINUE  ! END SUM(c,COM
      RS3=RS1
      RS4=RS2
      IF(RS4.NE.0.0) THEN
        RS5=RS3/RS4
      ELSE
        RS5=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS3
         ErrorRVal2=RS4
         ErrorIndName(1)='i           '
         ErrorIndVal(1)=I00003
         ErrorIndSetNo(1)=4
        END IF
      END IF
      LG1=RS5.GT.0.9
      IF(LG1) THEN
      IS1=1
      END IF
      SSMP(SSMPST(11)-1+I00003)=IS1
    1 CONTINUE  ! END (all,i,IND)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for set "LOCIND"',
     *  'at line 496 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00171')
      RETURN
      END
      SUBROUTINE S00172(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00046,C00053,C00111,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00046(SSZ(4),SSZ(1))
      REAL C00053(SSZ(4))
      REAL C00111(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGV1LAB_O"'
      CurrentAction2=
     *  'at line 505 in the TAB file'
      CurrentIGNO=418
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGV1LAB_O"',
     *  'at line 505 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00111(I00003,I00001)=C00053(I00003)*C00046(I00003,I00001)
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGV1LAB_O"',
     *  'at line 505 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00172')
      RETURN
      END
      SUBROUTINE S00173(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00111,C00112,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00111(SSZ(4),SSZ(1))
      REAL C00112(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGV1LAB_IO"'
      CurrentAction2=
     *  'at line 507 in the TAB file'
      CurrentIGNO=419
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGV1LAB_IO"',
     *  'at line 507 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00111(I00003,I00001)
    2 CONTINUE  ! END SUM(i,IND
      C00112(I00001)=RS1
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGV1LAB_IO"',
     *  'at line 507 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00173')
      RETURN
      END
      SUBROUTINE S00174(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00080,C00112,C00113,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00080(1)
      REAL C00112(SSZ(1))
      REAL C00113(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGINCSHR"'
      CurrentAction2=
     *  'at line 508 in the TAB file'
      CurrentIGNO=420
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGINCSHR"',
     *  'at line 508 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=C00112(I00001)
      RS2=C00080(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='r           '
         ErrorIndVal(1)=I00001
         ErrorIndSetNo(1)=1
        END IF
      END IF
      C00113(I00001)=RS3
    1 CONTINUE  ! END (all,r,REG)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGINCSHR"',
     *  'at line 508 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00174')
      RETURN
      END
      SUBROUTINE M00006(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      IF(ECHO1.AND.DOIG(360).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(360).NE.'n') then
      CALL S00156(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(360),
     *  C00014,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(361).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SALEMAT2',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(361).NE.'n') then
      CALL S00157(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(361),
     *  C00010,C00102,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(364).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'IMPSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(364).NE.'n') then
      CALL S00158(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(364),
     *  C00070,C00072,C00103,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.POSTSIMPASS2.AND.(.NOT.POSTSIMPASS3)) THEN
      ZDZVAL=999
      END IF
      IF(.NOT.POSTSIMPASS2.AND.(.NOT.POSTSIMPASS3)) THEN
      NDZVAL=999
      END IF
      IF(ECHO1.AND.DOIG(369).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SUPPLYELAST',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(369).NE.'n') then
      CALL S00159(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(369),
     *  C00021,C00023,C00029,C00053,C00054,C00058,C00104,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM) THEN
       CALL SSAL1C(.TRUE.,.TRUE.,105,MMNST,SSZ,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(ECHO1.AND.DOIG(375).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'FACTOR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(375).NE.'n') then
      CALL S00160(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(375),
     *  C00053,C00105,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(376).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'FACTOR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(376).NE.'n') then
      CALL S00161(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(376),
     *  C00021,C00105,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(377).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'FACTOR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(377).NE.'n') then
      CALL S00162(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(377),
     *  C00023,C00105,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(383).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V1PUR_SI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(383).NE.'n') then
      CALL S00163(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(383),
     *  C00055,C00106,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(384).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V2PUR_SI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(384).NE.'n') then
      CALL S00164(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(384),
     *  C00062,C00107,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(385).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V5PUR_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(385).NE.'n') then
      CALL S00165(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(385),
     *  C00052,C00108,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(386).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'V6BAS_S',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(386).NE.'n') then
      CALL S00166(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(386),
     *  C00010,C00109,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(394).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TARFRATE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(394).NE.'n') then
      CALL S00167(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(394),
     *  C00110,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(395).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TARFRATE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(395).NE.'n') then
      CALL S00168(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(395),
     *  C00027,C00087,C00110,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(404).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'V0CIF>0 if V0TAR<>0',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(404).NE.'n') then
      CALL S00169(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(404),
     *  C00027,C00087,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(406).EQ.'y') THEN
        CALL GPTO1(' Formula for set ''%t''',
     *    'LOCCOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(406).NE.'n') then
      CALL S00170(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(406),
     *  C00039,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=21
       SSNO=9
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,9,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=22
       SSNO=10
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,10,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(411).EQ.'y') THEN
        CALL GPTO1(' Formula for set ''%t''',
     *    'LOCIND',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(411).NE.'n') then
      CALL S00171(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(411),
     *  C00026,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=23
       SSNO=11
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,11,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(418).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGV1LAB_O',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(418).NE.'n') then
      CALL S00172(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(418),
     *  C00046,C00053,C00111,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(419).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGV1LAB_IO',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(419).NE.'n') then
      CALL S00173(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(419),
     *  C00111,C00112,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(420).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGINCSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(420).NE.'n') then
      CALL S00174(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(420),
     *  C00080,C00112,C00113,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('M00006')
      RETURN
      END
      SUBROUTINE S00175(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00040,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00040(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R001 = 1"'
      CurrentAction2=
     *  'at line 519 in the TAB file'
      CurrentIGNO=430
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R001 = 1"',
     *  'at line 519 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00040(I00003,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R001 = 1',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R001 = 1"',
     *  'at line 519 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R001 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00175')
      RETURN
15500 CALL PERETM('S00175',ERRMES)
      RETURN
      END
      SUBROUTINE S00176(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00041,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00041(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R002 = 1"'
      CurrentAction2=
     *  'at line 521 in the TAB file'
      CurrentIGNO=431
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R002 = 1"',
     *  'at line 521 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00041(I00003,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R002 = 1',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R002 = 1"',
     *  'at line 521 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R002 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00176')
      RETURN
15500 CALL PERETM('S00176',ERRMES)
      RETURN
      END
      SUBROUTINE S00177(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00042,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00042(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R003 = 1"'
      CurrentAction2=
     *  'at line 522 in the TAB file'
      CurrentIGNO=432
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R003 = 1"',
     *  'at line 522 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00042(I00002,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R003 = 1',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R003 = 1"',
     *  'at line 522 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R003 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00177')
      RETURN
15500 CALL PERETM('S00177',ERRMES)
      RETURN
      END
      SUBROUTINE S00178(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00043,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00043(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R004 = 1"'
      CurrentAction2=
     *  'at line 523 in the TAB file'
      CurrentIGNO=433
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R004 = 1"',
     *  'at line 523 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00043(I00002,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R004 = 1',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R004 = 1"',
     *  'at line 523 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R004 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00178')
      RETURN
15500 CALL PERETM('S00178',ERRMES)
      RETURN
      END
      SUBROUTINE S00179(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00044,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00044(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R005 = 1"'
      CurrentAction2=
     *  'at line 524 in the TAB file'
      CurrentIGNO=434
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R005 = 1"',
     *  'at line 524 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00044(I00002,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R005 = 1',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R005 = 1"',
     *  'at line 524 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R005 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00179')
      RETURN
15500 CALL PERETM('S00179',ERRMES)
      RETURN
      END
      SUBROUTINE S00180(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00045,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00045(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R006 = 1"'
      CurrentAction2=
     *  'at line 525 in the TAB file'
      CurrentIGNO=435
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R006 = 1"',
     *  'at line 525 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00045(I00002,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R006 = 1',
     *    I00002,0,0,0,0,0,0,
     *    2,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R006 = 1"',
     *  'at line 525 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R006 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00180')
      RETURN
15500 CALL PERETM('S00180',ERRMES)
      RETURN
      END
      SUBROUTINE S00181(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00046,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE TGBAS1
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER ASSVAL,MMEL,ELAD(MMNST)
      LOGICAL ASSOK
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00046(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'assertion "Sum-over-REG R007 = 1"'
      CurrentAction2=
     *  'at line 526 in the TAB file'
      CurrentIGNO=436
      CurrentIGTP='as'
      CALL GPAPRW(
     *  ' before calculating assertion "Sum-over-REG R007 = 1"',
     *  'at line 526 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      ASSOK=.TRUE.
      NumASSFailPos=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=0
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00046(I00003,I00001)
    2 CONTINUE  ! END SUM(r,REG
      LG1=ABS(REAL(1  -RS1)).LT.0.001
      IF(LG1) THEN
      IS1=1
      END IF
      ASSVAL=IS1
      IF(ASSVAL.NE.1) THEN
        CALL TGASF1(ASSOK,1,
     *'Sum-over-REG R007 = 1',
     *    I00003,0,0,0,0,0,0,
     *    4,0,0,0,0,0,0,
     *  MMNST,ELAD,STELST,STNM,MMEL,STEL,ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
        ASSOK=.FALSE.
      END IF
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating assertion "Sum-over-REG R007 = 1"',
     *  'at line 526 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(.NOT.ASSOK) THEN
       CALL TGASF2('tg',
     *'Sum-over-REG R007 = 1',
     *   ASSOK,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00181')
      RETURN
15500 CALL PERETM('S00181',ERRMES)
      RETURN
      END
      SUBROUTINE S00182(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00026,C00040,C00114,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00026(SSZ(2),SSZ(4))
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00114(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TOTSUPREG"'
      CurrentAction2=
     *  'at line 529 in the TAB file'
      CurrentIGNO=438
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TOTSUPREG"',
     *  'at line 529 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00026(I00002,I00003)*C00040(I00003,I00001)
    3 CONTINUE  ! END SUM(i,IND
      C00114(I00002,I00001)=RS1
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TOTSUPREG"',
     *  'at line 529 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00182')
      RETURN
      END
      SUBROUTINE S00183(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00006,C00007,C00008,C00009,C00010,C00040,C00041,
     *  C00042,C00043,C00044,C00045,C00115,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      REAL C00007(SSZ(2),SSZ(6))
      REAL C00008(SSZ(2))
      REAL C00009(SSZ(2),SSZ(6))
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00041(SSZ(4),SSZ(1))
      REAL C00042(SSZ(2),SSZ(1))
      REAL C00043(SSZ(2),SSZ(1))
      REAL C00044(SSZ(2),SSZ(1))
      REAL C00045(SSZ(2),SSZ(1))
      REAL C00115(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TOTDEMREG"'
      CurrentAction2=
     *  'at line 533 in the TAB file'
      CurrentIGNO=440
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TOTDEMREG"',
     *  'at line 533 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00040(I00003,I00001)*C00005(I00002,1,I00003)+
     *  C00041(I00003,I00001)*C00006(I00002,1,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00115(I00002,I00001)=RS1+C00042(I00002,I00001)*C00007(I00002,1)+
     *  C00043(I00002,I00001)*C00008(I00002)+C00044(I00002,I00001)*
     *  C00009(I00002,1)+C00045(I00002,I00001)*C00010(I00002,1)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TOTDEMREG"',
     *  'at line 533 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00183')
      RETURN
      END
      SUBROUTINE S00184(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00011,C00012,C00013,C00014,C00015,C00040,C00041,C00042,
     *  C00043,C00044,C00115,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER I00003
      INTEGER I00005
      INTEGER I00014
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00011(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00012(SSZ(2),SSZ(6),SSZ(4),SSZ(3))
      REAL C00013(SSZ(2),SSZ(6),SSZ(3))
      REAL C00014(SSZ(2),SSZ(3))
      REAL C00015(SSZ(2),SSZ(6),SSZ(3))
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00041(SSZ(4),SSZ(1))
      REAL C00042(SSZ(2),SSZ(1))
      REAL C00043(SSZ(2),SSZ(1))
      REAL C00044(SSZ(2),SSZ(1))
      REAL C00115(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TOTDEMREG"'
      CurrentAction2=
     *  'at line 540 in the TAB file'
      CurrentIGNO=441
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TOTDEMREG"',
     *  'at line 540 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(3)  ! (all,c,MAR)
      RS1=0.0
      DO 3 I00014=1,SSZ(2)  ! SUM(u,COM
      RS2=0.0
      DO 4 I00005=1,SSZ(6)  ! SUM(s,SRC
      RS3=0.0
      DO 5 I00003=1,SSZ(4)  ! SUM(i,IND
      RS3=RS3+C00040(I00003,I00001)*C00011(I00014,I00005,I00003,I00002)+
     *  C00041(I00003,I00001)*C00012(I00014,I00005,I00003,I00002)
    5 CONTINUE  ! END SUM(i,IND
      RS2=RS2+C00042(I00014,I00001)*C00013(I00014,I00005,I00002)+
     *  C00044(I00014,I00001)*C00015(I00014,I00005,I00002)+RS3
    4 CONTINUE  ! END SUM(s,SRC
      RS1=RS1+C00043(I00014,I00001)*C00014(I00014,I00002)+RS2
    3 CONTINUE  ! END SUM(u,COM
      C00115(SSMP(SSMPST(3)-1+I00002),I00001)=C00115(SSMP(SSMPST(3)-1+
     *  I00002),I00001)+RS1
    1 CONTINUE  ! END (all,c,MAR)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TOTDEMREG"',
     *  'at line 540 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00184')
      RETURN
      END
      SUBROUTINE S00185(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00047,C00114,C00115,C00116,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00047(1)
      REAL C00114(SSZ(2),SSZ(1))
      REAL C00115(SSZ(2),SSZ(1))
      REAL C00116(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DEMRATIO"'
      CurrentAction2=
     *  'at line 548 in the TAB file'
      CurrentIGNO=443
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DEMRATIO"',
     *  'at line 548 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=C00047(1)+C00115(I00002,I00001)
      RS2=C00047(1)+C00114(I00002,I00001)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=2
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
         ErrorIndName(2)='r           '
         ErrorIndVal(2)=I00001
         ErrorIndSetNo(2)=1
        END IF
      END IF
      C00116(I00002,I00001)=RS3
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DEMRATIO"',
     *  'at line 548 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00185')
      RETURN
      END
      SUBROUTINE S00186(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00116,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00116(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DEMRATIO"'
      CurrentAction2=
     *  'at line 550 in the TAB file'
      CurrentIGNO=444
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DEMRATIO"',
     *  'at line 550 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(22)  ! (all,c,NATCOM)
      C00116(SSMP(SSMPST(10)-1+I00002),I00001)=-C00116(SSMP(SSMPST(10)-
     *  1+I00002),I00001)
    1 CONTINUE  ! END (all,c,NATCOM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DEMRATIO"',
     *  'at line 550 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00186')
      RETURN
      END
      SUBROUTINE S00187(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00040,C00054,C00117,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00054(SSZ(4))
      REAL C00117(SSZ(4),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGV1PRIM"'
      CurrentAction2=
     *  'at line 559 in the TAB file'
      CurrentIGNO=451
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGV1PRIM"',
     *  'at line 559 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00117(I00003,I00001)=C00054(I00003)*C00040(I00003,I00001)
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGV1PRIM"',
     *  'at line 559 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00187')
      RETURN
      END
      SUBROUTINE S00188(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00117,C00119,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00117(SSZ(4),SSZ(1))
      REAL C00119(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGV1PRIM_I"'
      CurrentAction2=
     *  'at line 561 in the TAB file'
      CurrentIGNO=452
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGV1PRIM_I"',
     *  'at line 561 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00117(I00003,I00001)
    2 CONTINUE  ! END SUM(i,IND
      C00119(I00001)=RS1
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGV1PRIM_I"',
     *  'at line 561 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00188')
      RETURN
      END
      SUBROUTINE S00189(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00117,C00118,C00119,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00117(SSZ(4),SSZ(1))
      REAL C00118(SSZ(4),SSZ(1))
      REAL C00119(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "R00PRIM"'
      CurrentAction2=
     *  'at line 562 in the TAB file'
      CurrentIGNO=453
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "R00PRIM"',
     *  'at line 562 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      RS1=C00117(I00003,I00001)
      RS2=C00119(I00001)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=2
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='i           '
         ErrorIndVal(1)=I00003
         ErrorIndSetNo(1)=4
         ErrorIndName(2)='r           '
         ErrorIndVal(2)=I00001
         ErrorIndSetNo(2)=1
        END IF
      END IF
      C00118(I00003,I00001)=RS3
    1 CONTINUE  ! END (all,i,IND)
    2 CONTINUE  ! END (all,r,REG)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "R00PRIM"',
     *  'at line 562 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00189')
      RETURN
      END
      SUBROUTINE S00190(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00005,C00006,C00007,C00009,C00010,C00040,C00041,C00042,
     *  C00044,C00045,C00120,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00005(SSZ(2),SSZ(6),SSZ(4))
      REAL C00006(SSZ(2),SSZ(6),SSZ(4))
      REAL C00007(SSZ(2),SSZ(6))
      REAL C00009(SSZ(2),SSZ(6))
      REAL C00010(SSZ(2),SSZ(6))
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00041(SSZ(4),SSZ(1))
      REAL C00042(SSZ(2),SSZ(1))
      REAL C00044(SSZ(2),SSZ(1))
      REAL C00045(SSZ(2),SSZ(1))
      REAL C00120(SSZ(2),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TOTIMPREG"'
      CurrentAction2=
     *  'at line 571 in the TAB file'
      CurrentIGNO=460
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TOTIMPREG"',
     *  'at line 571 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(1)  ! (all,r,REG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 3 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00040(I00003,I00001)*C00005(I00002,2,I00003)+
     *  C00041(I00003,I00001)*C00006(I00002,2,I00003)
    3 CONTINUE  ! END SUM(i,IND
      C00120(I00002,I00001)=RS1+C00042(I00002,I00001)*C00007(I00002,2)+
     *  C00044(I00002,I00001)*C00009(I00002,2)+C00045(I00002,I00001)*
     *  C00010(I00002,2)
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TOTIMPREG"',
     *  'at line 571 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00190')
      RETURN
      END
      SUBROUTINE S00191(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00120,C00121,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00120(SSZ(2),SSZ(1))
      REAL C00121(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TOTIMP"'
      CurrentAction2=
     *  'at line 577 in the TAB file'
      CurrentIGNO=461
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TOTIMP"',
     *  'at line 577 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00001=1,SSZ(7)  ! SUM(r,ORG
      RS1=RS1+C00120(I00002,SSMP(SSMPST(2)-1+I00001))
    2 CONTINUE  ! END SUM(r,ORG
      C00121(I00002)=RS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TOTIMP"',
     *  'at line 577 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00191')
      RETURN
      END
      SUBROUTINE S00192(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00120,C00122,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00120(SSZ(2),SSZ(1))
      REAL C00122(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGIMPSHR"'
      CurrentAction2=
     *  'at line 578 in the TAB file'
      CurrentIGNO=462
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGIMPSHR"',
     *  'at line 578 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=0.0
      DO 2 I00002=1,SSZ(2)  ! SUM(c,COM
      RS1=RS1+C00120(I00002,I00001)
    2 CONTINUE  ! END SUM(c,COM
      C00122(I00001)=RS1
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGIMPSHR"',
     *  'at line 578 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00192')
      RETURN
      END
      SUBROUTINE S00193(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00122,C00123,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00122(SSZ(1))
      REAL C00123(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "IMPTOT"'
      CurrentAction2=
     *  'at line 579 in the TAB file'
      CurrentIGNO=463
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "IMPTOT"',
     *  'at line 579 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00122(I00001)
    1 CONTINUE  ! END SUM(r,REG
      C00123(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "IMPTOT"',
     *  'at line 579 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00193')
      RETURN
      END
      SUBROUTINE S00194(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00122,C00123,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00122(SSZ(1))
      REAL C00123(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "REGIMPSHR"'
      CurrentAction2=
     *  'at line 580 in the TAB file'
      CurrentIGNO=464
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "REGIMPSHR"',
     *  'at line 580 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=C00122(I00001)
      RS2=C00123(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='r           '
         ErrorIndVal(1)=I00001
         ErrorIndSetNo(1)=1
        END IF
      END IF
      C00122(I00001)=RS3
    1 CONTINUE  ! END (all,r,REG)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "REGIMPSHR"',
     *  'at line 580 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00194')
      RETURN
      END
      SUBROUTINE S00195(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00122,C00124,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00122(SSZ(1))
      REAL C00124(SSZ(2),SSZ(7))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MSHR"'
      CurrentAction2=
     *  'at line 587 in the TAB file'
      CurrentIGNO=467
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MSHR"',
     *  'at line 587 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00001=1,SSZ(7)  ! (all,r,ORG)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00124(I00002,I00001)=C00122(SSMP(SSMPST(2)-1+I00001))
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,r,ORG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MSHR"',
     *  'at line 587 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00195')
      RETURN
      END
      SUBROUTINE S00196(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00120,C00121,C00124,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL LG1
      LOGICAL ECHO1
      REAL C00120(SSZ(2),SSZ(1))
      REAL C00121(SSZ(2))
      REAL C00124(SSZ(2),SSZ(7))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MSHR"'
      CurrentAction2=
     *  'at line 588 in the TAB file'
      CurrentIGNO=468
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MSHR"',
     *  'at line 588 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM:)
      LG1=C00121(I00002).GT.0
      IF(LG1) THEN
      DO 2 I00001=1,SSZ(7)  ! (all,r,ORG)
      RS1=C00120(I00002,SSMP(SSMPST(2)-1+I00001))
      RS2=C00121(I00002)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=2
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
         ErrorIndName(2)='r           '
         ErrorIndVal(2)=I00001
         ErrorIndSetNo(2)=7
        END IF
      END IF
      C00124(I00002,I00001)=RS3
    2 CONTINUE  ! END (all,r,ORG)
      END IF ! IF(LG1) THEN
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MSHR"',
     *  'at line 588 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00196')
      RETURN
      END
      SUBROUTINE M00007(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(430).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R001 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(430).NE.'n') then
      CALL S00175(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(430),
     *  C00040,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(431).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R002 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(431).NE.'n') then
      CALL S00176(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(431),
     *  C00041,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(432).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R003 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(432).NE.'n') then
      CALL S00177(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(432),
     *  C00042,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(433).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R004 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(433).NE.'n') then
      CALL S00178(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(433),
     *  C00043,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(434).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R005 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(434).NE.'n') then
      CALL S00179(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(434),
     *  C00044,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(435).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R006 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(435).NE.'n') then
      CALL S00180(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(435),
     *  C00045,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(436).EQ.'y') THEN
      CALL GPTO1(' Assertion "%t"',
     *  'Sum-over-REG R007 = 1',
     *  0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(436).NE.'n') then
      CALL S00181(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(436),
     *  C00046,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(438).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TOTSUPREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(438).NE.'n') then
      CALL S00182(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(438),
     *  C00026,C00040,C00114,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(440).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TOTDEMREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(440).NE.'n') then
      CALL S00183(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(440),
     *  C00005,C00006,C00007,C00008,C00009,C00010,C00040,C00041,
     *  C00042,C00043,C00044,C00045,C00115,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(441).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TOTDEMREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(441).NE.'n') then
      CALL S00184(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(441),
     *  C00011,C00012,C00013,C00014,C00015,C00040,C00041,C00042,
     *  C00043,C00044,C00115,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(443).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DEMRATIO',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(443).NE.'n') then
      CALL S00185(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(443),
     *  C00047,C00114,C00115,C00116,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(444).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DEMRATIO',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(444).NE.'n') then
      CALL S00186(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(444),
     *  C00116,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(451).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGV1PRIM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(451).NE.'n') then
      CALL S00187(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(451),
     *  C00040,C00054,C00117,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(452).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGV1PRIM_I',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(452).NE.'n') then
      CALL S00188(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(452),
     *  C00117,C00119,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(453).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'R00PRIM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(453).NE.'n') then
      CALL S00189(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(453),
     *  C00117,C00118,C00119,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(460).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TOTIMPREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(460).NE.'n') then
      CALL S00190(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(460),
     *  C00005,C00006,C00007,C00009,C00010,C00040,C00041,C00042,
     *  C00044,C00045,C00120,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(461).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TOTIMP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(461).NE.'n') then
      CALL S00191(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(461),
     *  C00120,C00121,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(462).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGIMPSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(462).NE.'n') then
      CALL S00192(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(462),
     *  C00120,C00122,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(463).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'IMPTOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(463).NE.'n') then
      CALL S00193(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(463),
     *  C00122,C00123,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(464).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'REGIMPSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(464).NE.'n') then
      CALL S00194(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(464),
     *  C00122,C00123,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(467).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(467).NE.'n') then
      CALL S00195(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(467),
     *  C00122,C00124,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(468).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(468).NE.'n') then
      CALL S00196(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(468),
     *  C00120,C00121,C00124,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('M00007')
      RETURN
      END
      SUBROUTINE S00197(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00040,C00054,C00125,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00040(SSZ(4),SSZ(1))
      REAL C00054(SSZ(4))
      REAL C00125(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DEFREGSHR"'
      CurrentAction2=
     *  'at line 648 in the TAB file'
      CurrentIGNO=513
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DEFREGSHR"',
     *  'at line 648 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=0.0
      DO 2 I00003=1,SSZ(4)  ! SUM(i,IND
      RS1=RS1+C00040(I00003,I00001)*C00054(I00003)
    2 CONTINUE  ! END SUM(i,IND
      C00125(I00001)=RS1
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DEFREGSHR"',
     *  'at line 648 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00197')
      RETURN
      END
      SUBROUTINE S00198(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00125,C00126,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1
      LOGICAL ECHO1
      REAL C00125(SSZ(1))
      REAL C00126(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "TEMTOT"'
      CurrentAction2=
     *  'at line 650 in the TAB file'
      CurrentIGNO=514
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "TEMTOT"',
     *  'at line 650 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      RS1=0.0
      DO 1 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+C00125(I00001)
    1 CONTINUE  ! END SUM(r,REG
      C00126(1)=RS1
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "TEMTOT"',
     *  'at line 650 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00198')
      RETURN
      END
      SUBROUTINE S00199(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00125,C00126,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00125(SSZ(1))
      REAL C00126(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DEFREGSHR"'
      CurrentAction2=
     *  'at line 651 in the TAB file'
      CurrentIGNO=515
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DEFREGSHR"',
     *  'at line 651 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      RS1=C00125(I00001)
      RS2=C00126(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='r           '
         ErrorIndVal(1)=I00001
         ErrorIndSetNo(1)=1
        END IF
      END IF
      C00125(I00001)=RS3
    1 CONTINUE  ! END (all,r,REG)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DEFREGSHR"',
     *  'at line 651 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00199')
      RETURN
      END
      SUBROUTINE S00200(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00127,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00008
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      INTEGER IS1,IS2,IS3,IS4,IS5,IS6
      LOGICAL ECHO1
      REAL C00127(SSZ(1),SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DISTANCE"'
      CurrentAction2=
     *  'at line 655 in the TAB file'
      CurrentIGNO=517
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DISTANCE"',
     *  'at line 655 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00008=1,SSZ(1)  ! (all,d,REG)
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      IS1=I00001
      IS2=I00008
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS3=IS1-IS2
      ELSE
        IS3=GPINTOP('-',IS1,IS2)
      END IF
      IS4=2
      IS5=INT(ABS(IS3))
      IF(ABS(IS4).LE.1000000000.AND.
     *  ABS(IS5).LE.1000000000) THEN
        IS6=IS4+IS5
      ELSE
        IS6=GPINTOP('+',IS4,IS5)
      END IF
      C00127(I00001,I00008)=IS6
    1 CONTINUE  ! END (all,r,REG)
    2 CONTINUE  ! END (all,d,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DISTANCE"',
     *  'at line 655 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00200')
      RETURN
      END
      SUBROUTINE S00201(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00002,C00128,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER I00005
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      LOGICAL ECHO1
      REAL C00002(1)
      REAL C00128(SSZ(2),SSZ(6))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "DISTFAC"'
      CurrentAction2=
     *  'at line 661 in the TAB file'
      CurrentIGNO=520
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "DISTFAC"',
     *  'at line 661 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 2 I00005=1,SSZ(6)  ! (all,s,SRC)
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=1.5*(C00002(1)/2  .+ABS(REAL(I00002-(C00002(1)/2  .))))
      RS2=C00002(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=3
         NumActiveInd=2
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
         ErrorIndName(2)='s           '
         ErrorIndVal(2)=I00005
         ErrorIndSetNo(2)=6
        END IF
      END IF
      C00128(I00002,I00005)=RS3
    1 CONTINUE  ! END (all,c,COM)
    2 CONTINUE  ! END (all,s,SRC)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "DISTFAC"',
     *  'at line 661 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00201')
      RETURN
      END
      SUBROUTINE S00202(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00129,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00129(SSZ(1),SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MARWGT"'
      CurrentAction2=
     *  'at line 666 in the TAB file'
      CurrentIGNO=523
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MARWGT"',
     *  'at line 666 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 2 I00004=1,SSZ(3)  ! (all,m,MAR)
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      C00129(I00001,I00004)=1.0
    1 CONTINUE  ! END (all,r,REG)
    2 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MARWGT"',
     *  'at line 666 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00202')
      RETURN
      END
      SUBROUTINE S00203(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00004,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00004(1)
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      LOGICAL RUNTSS,PRELIM,DOPRE,DIDPRE
      INTEGER NSSMP
      COMMON /TGPREI/DOPRE,PRELIM,DIDPRE
      COMMON /TGTPSI/NSSMP,RUNTSS
      IER=0
      CurrentAction=
     *  'formula for set "DMAR"'
      CurrentAction2=
     *  'at line 669 in the TAB file'
      CurrentIGNO=526
      CurrentIGTP='st'
      CALL GPAPRW(
     *  ' before calculating formula for set "DMAR"',
     *  'at line 669 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IF((PRELIM.OR.POSTSIMPASS2).AND.RUNTSS) THEN
        SSMPST(12)=NSSMP+1
        CALL TGINCP(NSSMP+SSZ(3),DSSMP,'DSSMP',ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      DO 1 I00004=1,SSZ(3)  ! (all,m,MAR)
      IS1=0
      LG1=I00004.GT.0.5*C00004(1)
      IF(LG1) THEN
      IS1=1
      END IF
      SSMP(SSMPST(12)-1+I00004)=IS1
    1 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for set "DMAR"',
     *  'at line 669 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00203')
      RETURN
      END
      SUBROUTINE S00204(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00130,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00130(SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "LOCMAR"'
      CurrentAction2=
     *  'at line 677 in the TAB file'
      CurrentIGNO=530
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "LOCMAR"',
     *  'at line 677 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00004=1,SSZ(3)  ! (all,m,MAR)
      C00130(I00004)=1
    1 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "LOCMAR"',
     *  'at line 677 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00204')
      RETURN
      END
      SUBROUTINE S00205(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00125,C00131,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00125(SSZ(1))
      REAL C00131(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "RPOP"'
      CurrentAction2=
     *  'at line 681 in the TAB file'
      CurrentIGNO=533
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "RPOP"',
     *  'at line 681 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      C00131(I00001)=C00125(I00001)*10000000
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "RPOP"',
     *  'at line 681 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00205')
      RETURN
      END
      SUBROUTINE S00206(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00132,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00132(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SIGMADOMDOM"'
      CurrentAction2=
     *  'at line 685 in the TAB file'
      CurrentIGNO=536
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SIGMADOMDOM"',
     *  'at line 685 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00132(I00002)=5.0
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SIGMADOMDOM"',
     *  'at line 685 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00206')
      RETURN
      END
      SUBROUTINE S00207(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00133,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00004
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00133(SSZ(3))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "SIGMAMAR"'
      CurrentAction2=
     *  'at line 691 in the TAB file'
      CurrentIGNO=539
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "SIGMAMAR"',
     *  'at line 691 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00004=1,SSZ(3)  ! (all,m,MAR)
      C00133(I00004)=0.2
    1 CONTINUE  ! END (all,m,MAR)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "SIGMAMAR"',
     *  'at line 691 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00207')
      RETURN
      END
      SUBROUTINE S00208(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00001,C00116,C00134,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3,RS4
      LOGICAL ECHO1
      REAL C00001(1)
      REAL C00116(SSZ(2),SSZ(1))
      REAL C00134(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "XX"'
      CurrentAction2=
     *  'at line 696 in the TAB file'
      CurrentIGNO=542
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "XX"',
     *  'at line 696 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      RS1=0.0
      DO 2 I00001=1,SSZ(1)  ! SUM(r,REG
      RS1=RS1+ABS(REAL(1  -C00116(I00002,I00001)))
    2 CONTINUE  ! END SUM(r,REG
      RS2=RS1
      RS3=C00001(1)
      IF(RS3.NE.0.0) THEN
        RS4=RS2/RS3
      ELSE
        RS4=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS2
         ErrorRVal2=RS3
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      C00134(I00002)=RS4
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "XX"',
     *  'at line 696 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00208')
      RETURN
      END
      SUBROUTINE S00209(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00134,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL LG1
      INTEGER IS1
      LOGICAL ECHO1
      REAL C00134(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      LOGICAL RUNTSS,PRELIM,DOPRE,DIDPRE
      INTEGER NSSMP
      COMMON /TGPREI/DOPRE,PRELIM,DIDPRE
      COMMON /TGTPSI/NSSMP,RUNTSS
      IER=0
      CurrentAction=
     *  'formula for set "SELFSUFFIC"'
      CurrentAction2=
     *  'at line 697 in the TAB file'
      CurrentIGNO=544
      CurrentIGTP='st'
      CALL GPAPRW(
     *  ' before calculating formula for set "SELFSUFFIC"',
     *  'at line 697 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      IF((PRELIM.OR.POSTSIMPASS2).AND.RUNTSS) THEN
        SSMPST(13)=NSSMP+1
        CALL TGINCP(NSSMP+SSZ(2),DSSMP,'DSSMP',ERRMES)
        IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=0
      LG1=C00134(I00002).LT.0.01
      IF(LG1) THEN
      IS1=1
      END IF
      SSMP(SSMPST(13)-1+I00002)=IS1
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for set "SELFSUFFIC"',
     *  'at line 697 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00209')
      RETURN
      END
      SUBROUTINE M00008(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(513).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DEFREGSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(513).NE.'n') then
      CALL S00197(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(513),
     *  C00040,C00054,C00125,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(514).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'TEMTOT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(514).NE.'n') then
      CALL S00198(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(514),
     *  C00125,C00126,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(515).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DEFREGSHR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(515).NE.'n') then
      CALL S00199(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(515),
     *  C00125,C00126,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(517).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DISTANCE',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(517).NE.'n') then
      CALL S00200(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(517),
     *  C00127,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(520).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'DISTFAC',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(520).NE.'n') then
      CALL S00201(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(520),
     *  C00002,C00128,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(523).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MARWGT',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(523).NE.'n') then
      CALL S00202(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(523),
     *  C00129,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(526).EQ.'y') THEN
        CALL GPTO1(' Formula for set ''%t''',
     *    'DMAR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(526).NE.'n') then
      CALL S00203(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(526),
     *  C00004,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=24
       SSNO=12
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,12,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(530).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'LOCMAR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(530).NE.'n') then
      CALL S00204(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(530),
     *  C00130,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(533).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'RPOP',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(533).NE.'n') then
      CALL S00205(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(533),
     *  C00125,C00131,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(536).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SIGMADOMDOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(536).NE.'n') then
      CALL S00206(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(536),
     *  C00132,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(539).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'SIGMAMAR',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(539).NE.'n') then
      CALL S00207(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(539),
     *  C00133,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(542).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'XX',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(542).NE.'n') then
      CALL S00208(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(542),
     *  C00001,C00116,C00134,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(544).EQ.'y') THEN
        CALL GPTO1(' Formula for set ''%t''',
     *    'SELFSUFFIC',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(544).NE.'n') then
      CALL S00209(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(544),
     *  C00134,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=25
       SSNO=13
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,13,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('M00008')
      RETURN
      END
      SUBROUTINE S00210(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00135,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00001
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      INTEGER C00135(SSZ(1))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MAPREG"'
      CurrentAction2=
     *  'at line 710 in the TAB file'
      CurrentIGNO=557
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MAPREG"',
     *  'at line 710 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00001=1,SSZ(1)  ! (all,r,REG)
      C00135(I00001)=I00001
    1 CONTINUE  ! END (all,r,REG)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MAPREG"',
     *  'at line 710 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00210')
      RETURN
      END
      SUBROUTINE S00211(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00002,C00136,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      INTEGER IS1,IS2,IS3,IS4,IS5,IS6,IS7,IS8
      LOGICAL ECHO1
      REAL C00002(1)
      REAL C00136(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MPC"'
      CurrentAction2=
     *  'at line 716 in the TAB file'
      CurrentIGNO=562
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MPC"',
     *  'at line 716 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      IS1=I00002
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS3=IS1-IS2
      ELSE
        IS3=GPINTOP('-',IS1,IS2)
      END IF
      IS4=10
      IF(ABS(IS4).LE.40000.AND.
     *  ABS(IS3).LE.40000) THEN
        IS5=IS4*IS3
      ELSE
        IS5=GPINTOP('*',IS4,IS3)
      END IF
      RS1=IS5
      RS2=C00002(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='c           '
         ErrorIndVal(1)=I00002
         ErrorIndSetNo(1)=2
        END IF
      END IF
      IS6=1
      IS7=INT(REAL(RS3))
      IF(ABS(IS6).LE.1000000000.AND.
     *  ABS(IS7).LE.1000000000) THEN
        IS8=IS6+IS7
      ELSE
        IS8=GPINTOP('+',IS6,IS7)
      END IF
      C00136(I00002)=IS8
    1 CONTINUE  ! END (all,c,COM)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MPC"',
     *  'at line 716 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00211')
      RETURN
      END
      SUBROUTINE S00212(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00136,C00137,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00002
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00136(SSZ(2))
      INTEGER C00137(SSZ(2))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MAPCOM"'
      CurrentAction2=
     *  'at line 718 in the TAB file'
      CurrentIGNO=564
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MAPCOM"',
     *  'at line 718 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00002=1,SSZ(2)  ! (all,c,COM)
      C00137(I00002)=INT(REAL(C00136(I00002)))
    1 CONTINUE  ! END (all,c,COM)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MAPCOM"',
     *  'at line 718 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00212')
      RETURN
      END
      SUBROUTINE S00213(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00003,C00138,
     *  ZDZVAL,NDZVAL,ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      REAL ZDZVAL,NDZVAL
      INTEGER NZDZ,NNDZ
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      REAL RS1,RS2,RS3
      INTEGER IS1,IS2,IS3,IS4,IS5,IS6,IS7,IS8
      LOGICAL ECHO1
      REAL C00003(1)
      REAL C00138(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MPI"'
      CurrentAction2=
     *  'at line 724 in the TAB file'
      CurrentIGNO=569
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MPI"',
     *  'at line 724 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      NZDZ=0
      NNDZ=0
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      IS1=I00003
      IS2=1
      IF(ABS(IS1).LE.1000000000.AND.
     *  ABS(IS2).LE.1000000000) THEN
        IS3=IS1-IS2
      ELSE
        IS3=GPINTOP('-',IS1,IS2)
      END IF
      IS4=10
      IF(ABS(IS4).LE.40000.AND.
     *  ABS(IS3).LE.40000) THEN
        IS5=IS4*IS3
      ELSE
        IS5=GPINTOP('*',IS4,IS3)
      END IF
      RS1=IS5
      RS2=C00003(1)
      IF(RS2.NE.0.0) THEN
        RS3=RS1/RS2
      ELSE
        RS3=1.0
        IF (IER.EQ.0) THEN
         IER=2
         ErrorDivNo=1
         NumActiveInd=1
         ErrorRVal1=RS1
         ErrorRVal2=RS2
         ErrorIndName(1)='i           '
         ErrorIndVal(1)=I00003
         ErrorIndSetNo(1)=4
        END IF
      END IF
      IS6=1
      IS7=INT(REAL(RS3))
      IF(ABS(IS6).LE.1000000000.AND.
     *  ABS(IS7).LE.1000000000) THEN
        IS8=IS6+IS7
      ELSE
        IS8=GPINTOP('+',IS6,IS7)
      END IF
      C00138(I00003)=IS8
    1 CONTINUE  ! END (all,i,IND)
      IF(ECHO1.AND.IER.EQ.0) THEN
       CALL TBEDZ(NZDZ,ZDZVAL,NNDZ,NDZVAL,'fm',ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MPI"',
     *  'at line 724 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00213')
      RETURN
      END
      SUBROUTINE S00214(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOCIG,
     *  C00138,C00139,
     *  ERRMES)
      USE PSIMMOD1
      USE ARITHERROR
      USE GSINC6
      INTEGER MMNSS,SSIOS(MMNSS),SSMPST(MMNSS+1)
      INTEGER AXSUN
      CHARACTER*(*) DOCIG
      INTEGER I00003
      INTEGER MMNST,SSZ(MMNST),STIST(MMNST),IER,KK
      LOGICAL LGX
      INTEGER MMEL,ELAD(MMNST),TGEPOS
      CHARACTER*(*) STELST(MMNST),STNM(MMNST),STEL(MMEL)
      LOGICAL ECHO1
      REAL C00138(SSZ(4))
      INTEGER C00139(SSZ(4))
      CHARACTER*(*) ERRMES
      REAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL ID01,ID0V,GPRAND,TGFCMN,TGFNOR,TGFRAS
      EXTERNAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      REAL TGERF,TGERFCC,TGFLNOR,TGFCMLN
      EXTERNAL GPINTOP, TGIINSNewPOS
      INTEGER GPINTOP, TGIINSNewPOS
      IER=0
      CurrentAction=
     *  'formula for coefficient "MAPIND"'
      CurrentAction2=
     *  'at line 726 in the TAB file'
      CurrentIGNO=571
      CurrentIGTP='fm'
      CALL GPAPRW(
     *  ' before calculating formula for coefficient "MAPIND"',
     *  'at line 726 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(DOCIG.EQ.'n') GOTO 9000
      DO 1 I00003=1,SSZ(4)  ! (all,i,IND)
      C00139(I00003)=INT(REAL(C00138(I00003)))
    1 CONTINUE  ! END (all,i,IND)
      IF(IER.NE.0) THEN
        CALL TGIER(IER,AXSUN,ERRMES)
        GOTO 15000
      END IF
      CALL GPAPRW2(.TRUE.,AXSUN,.FALSE.,0,
     *  ' while calculating formula for coefficient "MAPIND"',
     *  'at line 726 in the TAB file',
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
9000  CONTINUE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('S00214')
      RETURN
      END
      SUBROUTINE M00009(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=26
       SSNO=14
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,14,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=26
       SSNO=15
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,15,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=1
       SSNO=16
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,16,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(PRELIM.OR.POSTSIMPASS2) THEN
       LITSN=27
       SSNO=17
       IF((PRELIM.AND.SSPOSTSIM(SSNO).EQ.'n').OR.
     *     (POSTSIMPASS2.AND.SSPOSTSIM(SSNO).EQ.'y')) THEN
        IF(SSMPST(SSNO).LE.0) THEN
         SSMPST(SSNO)=NSSMP+1
         NSSMP=NSSMP+SSZ(LITSN)
         CALL TGINCP(NSSMP+MAX(1,SSZ(LITSN))-SSZ(LITSN),
     *     DSSMP,'DSSMP',ERRMES)
         IF(ERRMES(1:1).EQ.'E') GOTO 15000
        END IF
       END IF
      END IF
      CALL TGNISS('tg',AXSUN,17,DSSMP,SSMP,
     *  MMNST,STNM,SSZ,SZUB,ELAD,MMEL,STEL,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,MMNSS,SSMPST,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(557).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MAPREG',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(557).NE.'n') then
      CALL S00210(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(557),
     *  C00135,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(562).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MPC',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(562).NE.'n') then
      CALL S00211(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(562),
     *  C00002,C00136,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(564).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MAPCOM',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(564).NE.'n') then
      CALL S00212(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(564),
     *  C00136,C00137,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGST('tg',AXSUN,SETNO,MMNST,NUMST,SSZ,SZUB,
     *  STIST,ELAD,STNM,STELST,STTP,
     *  MMNFL,AFN,AFS,LFNORD,RDFSNO,RDUN,FSTPAS,
     *  MMNCS,CSPOS,CSPOSTSIM,MMNVC,VCWKST,
     *  DSSMP,SSMP,MMNSS,SSMPST,SERTAB,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      IF(ECHO1.AND.DOIG(569).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MPI',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(569).NE.'n') then
      CALL S00213(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(569),
     *  C00003,C00138,
     *  ZDZVAL,NDZVAL,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(ECHO1.AND.DOIG(571).EQ.'y') THEN
        CALL GPTO1(' Formula for ''%t''',
     *    'MAPIND',0,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(DOIG(571).NE.'n') then
      CALL S00214(MMNSS,SSIOS,ECHO1,
     *  MMNST,SSZ,STIST,ELAD,STELST,STNM,MMEL,STEL,
     *  SSMPST,AXSUN,
     *  DOIG(571),
     *  C00138,C00139,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ELSE
      call SKARB(axsun,1,filpb,tfilpb,errmes)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      CALL TGSCRS('tg',1,CALC1,DODS,DOWR,CTRTHR,
     *  AXSUN,RDUN,WRUN,DSPUN,CWKUN,
     *  LFNORD,LFNOWR,LFFOWR,NUMFL,RDFSNO,WRFSNO,
     *  DSPPW,DSPPL,DSPDEC,MMR,MMRDR,
     *  KSTEPA,NPASSA,KSINT,KSINTA,NSINT,
     *  DSALLS,WTALLS,WTMO,.FALSE.,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  SUVFI,
     *  TMPLG1,TMPI1,
     *  ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      RETURN
15000 CALL PERET('M00009')
      RETURN
      END
      SUBROUTINE M00010(RDUN,MMI,MMR,
     *  LFNORD,LFNOWR,LFFOWR,RDFSNO,WRFSNO,WTMO,
     *  KSINT,NSINT,KSINTA,
     *  RWA,NUMFL,
     *  IWA,OVOK,
     *  KMSTSL,AUTACC,SILEN,MINSIL,MINSFL,
     *  UDRTST,INRTST,CONTSI,
     *  AXSUN,AXTUN,WRUN,CWKUN,MMRDR,DSPUN,DSPPW,DSPPL,DSPDEC,
     *  DODS,DOWR,DOEQ,DSALLS,WTALLS,KSTEPA,NPASSA,SERTAB,
     *  DSPANP,DSPOIM,D1DROW,DSPCPN,DSPCLN,NELTX,
     *  DSSMAP,SSMAP,
     *  DOUD,
     *  CALC1,FSTPAS,CTRTHR,SUVFI,ERRMES)
      USE GSINC4
      USE GSINC7
      USE GSINC4
      USE init_c5
      USE TGSMVL
      USE GSINC1
      USE GSINC5
      USE SMVLST0
      USE TGDEBG
      USE PSIMMOD1
      USE SIMRES0
      USE GSINC3
      USE GSINC6
      INTEGER MMI,MMR
      INTEGER RDUN,WRUN,CWKUN,MMRDR
      INTEGER NUMFL,AXSUN,AXTUN
      INTEGER KSINT,NSINT,KSINTA
      REAL RWA(DWA)
      INTEGER DSPUN,DSPPW,DSPPL,DSPDEC
      INTEGER IWA(DIWA),TMPI1
      INTEGER KMSTSL
      LOGICAL AUTACC,CONTSI
      CHARACTER*(*) MINSFL,UDRTST,INRTST
      REAL MINSIL
      DOUBLE PRECISION SILEN
      INTEGER DRCOW
      PARAMETER(DRCOW=1)
      REAL RCOW(DRCOW)
      CHARACTER*(*) LFFOWR,WTMO
      CHARACTER*(*) ERRMES
      LOGICAL DOUD
      LOGICAL SKPSMD,LOWMEM,CALC1,FSTPAS,CTRTHR,SUVFI,TMPLG1
      LOGICAL DSALLS,WTALLS,DODS,DOWR,DOEQ,OVOK,SERTAB
      LOGICAL DSPANP,DSPOIM,D1DROW,NELTX
      INTEGER KSTEPA,NPASSA,DSPCPN,DSPCLN
      INTEGER DSSMAP,SSMAP(DSSMAP)
      INTEGER LFNORD,LFNOWR,RDFSNO,WRFSNO
      INTEGER SSNO,LITSN,SETNO
      CHARACTER SSTP,SETTP
      LOGICAL DOTHIS
      COMMON/DTHIS/DOTHIS
      LOWMEM=.FALSE.
      IF(FSTPAS.OR.PRELIM)THEN
      CALL TGCHMR(FSTPAS.OR.PRELIM,'MAPREG      ',1,27,
     *  MMNST,SSZ,SSZ(1),C00135,1,
     *  'o','REG         ','AGGREG      ',
     *  MMEL,STEL,ELAD(27)-1,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(PRELIM.OR.FSTPAS) THEN
       CALL TGRSMV(135,1,MMNST,SSZ,
     *   MMNCS,SMVLST,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(FSTPAS.OR.PRELIM)THEN
      CALL TGCHMR(FSTPAS.OR.PRELIM,'MAPCOM      ',2,28,
     *  MMNST,SSZ,SSZ(2),C00137,1,
     *  'o','COM         ','AGGCOM      ',
     *  MMEL,STEL,ELAD(28)-1,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(PRELIM.OR.FSTPAS) THEN
       CALL TGRSMV(137,2,MMNST,SSZ,
     *   MMNCS,SMVLST,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      IF(FSTPAS.OR.PRELIM)THEN
      CALL TGCHMR(FSTPAS.OR.PRELIM,'MAPIND      ',4,29,
     *  MMNST,SSZ,SSZ(4),C00139,1,
     *  'o','IND         ','AGGIND      ',
     *  MMEL,STEL,ELAD(29)-1,ERRMES)
      IF(ERRMES(1:1).EQ.'E') GOTO 15000
      ENDIF
      IF(PRELIM.OR.FSTPAS) THEN
       CALL TGRSMV(139,4,MMNST,SSZ,
     *   MMNCS,SMVLST,ERRMES)
       IF(ERRMES(1:1).EQ.'E') GOTO 15000
      END IF
      RETURN
15000 CALL PERET('M00010')
      RETURN
      END
      SUBROUTINE SSDAUC(ERRMES)
      CHARACTER*(*) ERRMES
      RETURN
      END
      SUBROUTINE SSALVC(MMNST,SSZ,ERRMES)
      CHARACTER*(*) ERRMES
      INTEGER MMNST,SSZ(MMNST)
      RETURN
      END
      SUBROUTINE GPEQN1(EQNUM,CHAR,LCHAR,ERRMES)
      INTEGER EQNUM,LCHAR
      CHARACTER*(*) CHAR,ERRMES
      return
      END
      include 'ssstuff.for'
      include 'tgscrs1.for'
      USE init_c3
      include 'tgscrs2.for'
      include 'tgwcvv1.for'
      USE init_c3
      include 'tgwcvv2.for'
      include 'tgutca1.for'
      USE init_c3
      include 'tgutca2.for'
      include 'tgcuvtv1.for'
      USE init_c3
      include 'tgcuvtv2.for'
      include 'tg1datcv1.for'
      USE init_c3
      include 'tg1datcv2.for'
      include 'tbsstp1.for'
      USE gsinc5
      include 'tbsstp2.for'
      include 'tbsssp1.for'
      USE gsinc5
      include 'tbsssp2.for'
      include 'tbscsp1.for'
      USE gsinc1
      include 'tbscsp2.for'
